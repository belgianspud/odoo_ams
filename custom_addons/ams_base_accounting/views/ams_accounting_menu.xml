<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Member Payment Performance Action (was missing) -->
    <record id="action_member_payment_performance" model="ir.actions.act_window">
        <field name="name">Member Payment Performance</field>
        <field name="res_model">account.move</field>
        <field name="view_mode">pivot,graph,list</field>
        <field name="domain">[('move_type', '=', 'out_invoice'), ('has_ams_products', '=', True)]</field>
        <field name="context">{
            'search_default_group_by_payment_status': 1,
            'search_default_group_by_ams_transaction_type': 1,
            'pivot_row_groupby': ['payment_state'],
            'pivot_col_groupby': ['ams_transaction_type'],
            'pivot_measures': ['amount_total']
        }</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Member Payment Performance Analysis
            </p>
            <p>
                <strong>Understand how well your members pay their bills:</strong>
                <br/>• Payment rates by service type
                <br/>• Outstanding balance trends
                <br/>• Collection effectiveness
                <br/>• Cash flow planning
            </p>
        </field>
    </record>

    <!-- Outstanding Member Invoices Action (was missing) -->
    <record id="action_outstanding_member_invoices" model="ir.actions.act_window">
        <field name="name">Outstanding Member Invoices</field>
        <field name="res_model">account.move</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('move_type', '=', 'out_invoice'), ('has_ams_products', '=', True), ('payment_state', 'in', ['not_paid', 'partial'])]</field>
        <field name="context">{
            'search_default_filter_unpaid_member_invoices': 1,
            'search_default_group_by_ams_transaction_type': 1
        }</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                All Member Invoices Are Paid!
            </p>
            <p>
                <strong>Outstanding Member Invoices</strong>
                <br/>Track and follow up on unpaid member invoices.
            </p>
        </field>
    </record>

    <!-- Member Invoice Dashboard Action (was missing) -->
    <record id="action_member_invoice_dashboard" model="ir.actions.act_window">
        <field name="name">Member Invoice Dashboard</field>
        <field name="res_model">account.move</field>
        <field name="view_mode">graph,pivot,list,form</field>
        <field name="domain">[('move_type', '=', 'out_invoice'), ('has_ams_products', '=', True)]</field>
        <field name="context">{
            'search_default_group_by_ams_transaction_type': 1,
            'search_default_group_by_billing_month': 1,
            'graph_measure': 'amount_total',
            'graph_type': 'bar'
        }</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Member Invoice Analytics Dashboard
            </p>
            <p>
                <strong>Analyze member billing patterns and payment trends</strong>
            </p>
        </field>
    </record>
    <!-- Main AMS Root Menu (if not already created by another module) -->
    <menuitem id="menu_ams_main"
              name="Association Management"
              sequence="50"/>

    <!-- Main AMS Financial Management Menu -->
    <menuitem id="menu_ams_financial_management"
              name="Financial Management"
              parent="menu_ams_main"
              groups="ams_base_accounting.group_ams_financial_user"
              sequence="30"/>

    <!-- Daily Operations Submenu -->
    <menuitem id="menu_ams_financial_daily_ops"
              name="Daily Operations"
              parent="menu_ams_financial_management"
              groups="ams_base_accounting.group_ams_financial_user"
              sequence="10"/>

    <!-- Member Invoices - Daily Operations -->
    <menuitem id="menu_ams_member_invoices_daily"
              name="Member Invoices"
              parent="menu_ams_financial_daily_ops"
              action="action_member_invoice_dashboard"
              groups="ams_base_accounting.group_ams_financial_user"
              sequence="10"/>

    <!-- Outstanding Member Invoices -->
    <menuitem id="menu_ams_outstanding_invoices"
              name="Outstanding Invoices"
              parent="menu_ams_financial_daily_ops"
              action="action_outstanding_member_invoices"
              groups="ams_base_accounting.group_ams_financial_user"
              sequence="20"/>

    <!-- Member Payment Processing -->
    <menuitem id="menu_ams_member_payment_processing"
              name="Member Payment Processing"
              parent="menu_ams_financial_daily_ops"
              action="action_member_payment_processing"
              groups="ams_base_accounting.group_ams_financial_user"
              sequence="30"/>

    <!-- Account Management Submenu -->
    <menuitem id="menu_ams_account_management"
              name="Account Management"
              parent="menu_ams_financial_management"
              groups="ams_base_accounting.group_ams_financial_manager"
              sequence="20"/>

    <!-- Chart of Accounts -->
    <menuitem id="menu_ams_chart_of_accounts"
              name="Chart of Accounts"
              parent="menu_ams_account_management"
              action="action_ams_chart_of_accounts"
              groups="ams_base_accounting.group_ams_financial_manager"
              sequence="10"/>

    <!-- Account Configuration -->
    <menuitem id="menu_ams_account_configuration"
              name="Account Configuration"
              parent="menu_ams_account_management"
              action="action_ams_account_configuration"
              groups="ams_base_accounting.group_ams_financial_manager"
              sequence="20"/>

    <!-- Journal Management -->
    <menuitem id="menu_ams_journal_management"
              name="Journal Management"
              parent="menu_ams_account_management"
              action="action_ams_journal_management"
              groups="ams_base_accounting.group_ams_financial_manager"
              sequence="30"/>

    <!-- Financial Reports Submenu -->
    <menuitem id="menu_ams_financial_reports"
              name="Financial Reports"
              parent="menu_ams_financial_management"
              groups="ams_base_accounting.group_ams_financial_user"
              sequence="30"/>

    <!-- Member Revenue Reports -->
    <menuitem id="menu_ams_member_revenue_reports"
              name="Member Revenue Reports"
              parent="menu_ams_financial_reports"
              action="action_member_revenue_reports"
              groups="ams_base_accounting.group_ams_financial_user"
              sequence="10"/>

    <!-- Payment Analysis Reports -->
    <menuitem id="menu_ams_payment_analysis_reports"
              name="Payment Analysis"
              parent="menu_ams_financial_reports"
              action="action_member_payment_performance"
              groups="ams_base_accounting.group_ams_financial_user"
              sequence="20"/>

    <!-- Financial Dashboards -->
    <menuitem id="menu_ams_financial_dashboards"
              name="Financial Dashboards"
              parent="menu_ams_financial_reports"
              action="action_ams_financial_dashboard"
              groups="ams_base_accounting.group_ams_financial_user"
              sequence="30"/>

    <!-- Setup and Configuration Submenu -->
    <menuitem id="menu_ams_financial_setup"
              name="Setup &amp; Configuration"
              parent="menu_ams_financial_management"
              groups="ams_base_accounting.group_ams_financial_manager"
              sequence="40"/>

    <!-- AMS Accounting Setup Wizard -->
    <menuitem id="menu_ams_accounting_setup_wizard"
              name="Financial Setup Wizard"
              parent="menu_ams_financial_setup"
              action="action_ams_accounting_setup_wizard"
              groups="ams_base_accounting.group_ams_financial_manager"
              sequence="10"/>

    <!-- Product Financial Configuration -->
    <menuitem id="menu_ams_product_financial_config"
              name="Product Financial Configuration"
              parent="menu_ams_financial_setup"
              action="action_ams_product_financial_config"
              groups="ams_base_accounting.group_ams_financial_manager"
              sequence="20"/>

    <!-- System Configuration -->
    <menuitem id="menu_ams_system_financial_config"
              name="System Configuration"
              parent="menu_ams_financial_setup"
              action="action_ams_system_configuration"
              groups="ams_base_accounting.group_ams_financial_admin"
              sequence="30"/>

    <!-- Enhanced Actions with Business Context -->

    <!-- Member Payment Processing Action -->
    <record id="action_member_payment_processing" model="ir.actions.act_window">
        <field name="name">Member Payment Processing</field>
        <field name="res_model">account.payment</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('partner_type', '=', 'customer'), ('partner_id.is_ams_member', '=', True)]</field>
        <field name="context">{
            'search_default_filter_draft_payments': 1,
            'search_default_group_by_payment_method': 1,
            'default_partner_type': 'customer',
            'default_payment_type': 'inbound'
        }</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Member Payment Processing Center
            </p>
            <p>
                <strong>Process Member Payments Efficiently</strong>
                <br/>Record and manage all payments received from association members.
            </p>
        </field>
    </record>

    <!-- AMS Chart of Accounts Action -->
    <record id="action_ams_chart_of_accounts" model="ir.actions.act_window">
        <field name="name">Association Chart of Accounts</field>
        <field name="res_model">account.account</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[]</field>
        <field name="context">{
            'search_default_filter_ams_accounts': 1,
            'search_default_group_by_ams_category': 1
        }</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Association Chart of Accounts
            </p>
        </field>
    </record>

    <!-- AMS Account Configuration Action -->
    <record id="action_ams_account_configuration" model="ir.actions.act_window">
        <field name="name">Association Account Configuration</field>
        <field name="res_model">account.account</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('is_ams_account', '=', True)]</field>
        <field name="context">{
            'search_default_filter_ams_accounts': 1,
            'search_default_group_by_ams_category': 1
        }</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Association Account Configuration
            </p>
        </field>
    </record>

    <!-- AMS Journal Management Action -->
    <record id="action_ams_journal_management" model="ir.actions.act_window">
        <field name="name">Association Journal Management</field>
        <field name="res_model">account.journal</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[]</field>
        <field name="context">{
            'search_default_filter_ams_journals': 1,
            'search_default_group_by_type': 1
        }</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Association Journal Management
            </p>
        </field>
    </record>

    <!-- Member Revenue Reports Action -->
    <record id="action_member_revenue_reports" model="ir.actions.act_window">
        <field name="name">Member Revenue Reports</field>
        <field name="res_model">account.move.line</field>
        <field name="view_mode">pivot,graph,list</field>
        <field name="domain">[('move_id.move_type', '=', 'out_invoice'), ('is_ams_line', '=', True)]</field>
        <field name="context">{
            'search_default_group_by_ams_product_type': 1,
            'search_default_group_by_date_month': 1,
            'pivot_row_groupby': ['product_id.ams_product_type'],
            'pivot_col_groupby': ['date:month'],
            'pivot_measures': ['price_subtotal'],
            'graph_measure': 'price_subtotal',
            'graph_type': 'line'
        }</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Member Revenue Analysis Reports
            </p>
        </field>
    </record>

    <!-- AMS Financial Dashboard Action -->
    <record id="action_ams_financial_dashboard" model="ir.actions.act_window">
        <field name="name">Association Financial Dashboard</field>
        <field name="res_model">account.move</field>
        <field name="view_mode">graph,pivot,kanban,list</field>
        <field name="domain">[('move_type', '=', 'out_invoice'), ('has_ams_products', '=', True)]</field>
        <field name="context">{
            'search_default_group_by_ams_transaction_type': 1,
            'search_default_group_by_date_month': 1,
            'graph_measure': 'amount_total',
            'graph_type': 'bar'
        }</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Association Financial Performance Dashboard
            </p>
        </field>
    </record>

    <!-- AMS Product Financial Configuration Action -->
    <record id="action_ams_product_financial_config" model="ir.actions.act_window">
        <field name="name">Product Financial Configuration</field>
        <field name="res_model">product.template</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('is_subscription_product', '=', True), ('use_ams_accounting', '=', True)]</field>
        <field name="context">{
            'search_default_filter_ams_products': 1,
            'search_default_group_by_ams_product_type': 1
        }</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Configure Product Financial Settings
            </p>
        </field>
    </record>

    <!-- AMS System Configuration Action -->
    <record id="action_ams_system_configuration" model="ir.actions.act_window">
        <field name="name">AMS System Configuration</field>
        <field name="res_model">res.config.settings</field>
        <field name="view_mode">form</field>
        <field name="target">inline</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Association Management System Configuration
            </p>
        </field>
    </record>

    <!-- Quick Access Links in Main AMS Menu -->
    <menuitem id="menu_ams_quick_financial_overview"
              name="Financial Overview"
              parent="menu_ams_main"
              action="action_ams_financial_dashboard"
              groups="ams_base_accounting.group_ams_financial_user"
              sequence="25"/>

    <!-- Integration with Existing Accounting Menu (if present) -->
    <menuitem id="menu_ams_integration_accounting"
              name="Association Accounting"
              parent="account.menu_finance"
              sequence="100"
              groups="account.group_account_user"/>

    <!-- AMS Invoices in Accounting Menu -->
    <menuitem id="menu_ams_invoices_accounting_section"
              name="Member Invoices"
              parent="menu_ams_integration_accounting"
              action="action_member_invoice_dashboard"
              sequence="10"/>

    <!-- AMS Payments in Accounting Menu -->
    <menuitem id="menu_ams_payments_accounting_section"
              name="Member Payments"
              parent="menu_ams_integration_accounting"
              action="action_member_payment_processing"
              sequence="20"/>

    <!-- AMS Accounts in Accounting Menu -->
    <menuitem id="menu_ams_accounts_accounting_section"
              name="Association Accounts"
              parent="menu_ams_integration_accounting"
              action="action_ams_chart_of_accounts"
              sequence="30"/>

    <!-- Reports Section - Integration with Main Reports -->
    <menuitem id="menu_ams_reports_integration"
              name="Association Reports"
              parent="account.menu_finance_reports"
              sequence="100"/>

    <!-- Member Financial Reports in Reports Menu -->
    <menuitem id="menu_ams_member_reports_section"
              name="Member Financial Reports"
              parent="menu_ams_reports_integration"
              action="action_member_revenue_reports"
              sequence="10"/>

    <!-- Payment Analysis in Reports Menu -->
    <menuitem id="menu_ams_payment_reports_section"
              name="Payment Analysis Reports"
              parent="menu_ams_reports_integration"
              action="action_member_payment_performance"
              sequence="20"/>

    <!-- Dashboard Link in Reports Menu -->
    <menuitem id="menu_ams_dashboard_reports_section"
              name="Financial Dashboard"
              parent="menu_ams_reports_integration"
              action="action_ams_financial_dashboard"
              sequence="30"/>

</odoo>