<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- =================================================================== -->
    <!-- SPECIALIZED GRAPH VIEWS FOR DASHBOARD (DEFINED FIRST)              -->
    <!-- =================================================================== -->
    
    <record id="view_ams_revenue_graph_dashboard" model="ir.ui.view">
        <field name="name">ams.revenue.graph.dashboard</field>
        <field name="model">account.move</field>
        <field name="arch" type="xml">
            <graph string="💰 Revenue Trends" type="line" sample="1">
                <field name="date" interval="month"/>
                <field name="amount_total" type="measure"/>
            </graph>
        </field>
    </record>

    <record id="view_ams_payment_status_graph" model="ir.ui.view">
        <field name="name">ams.payment.status.graph</field>
        <field name="model">account.move</field>
        <field name="arch" type="xml">
            <graph string="💳 Payment Status" type="pie" sample="1">
                <field name="payment_state"/>
                <field name="amount_total" type="measure"/>
            </graph>
        </field>
    </record>

    <record id="view_ams_customer_revenue_pivot" model="ir.ui.view">
        <field name="name">ams.customer.revenue.pivot</field>
        <field name="model">account.move</field>
        <field name="arch" type="xml">
            <pivot string="📊 Customer Revenue Analysis" sample="1">
                <field name="partner_id" type="row"/>
                <field name="date" interval="month" type="col"/>
                <field name="amount_total" type="measure"/>
            </pivot>
        </field>
    </record>

    <!-- =================================================================== -->
    <!-- SPECIALIZED DASHBOARD ACTIONS (Non-conflicting)                    -->
    <!-- =================================================================== -->
    
    <!-- Revenue Health Overview (Enhanced dashboard-specific action) -->
    <record id="action_ams_revenue_health_overview" model="ir.actions.act_window">
        <field name="name">📊 Revenue Health Overview</field>
        <field name="res_model">account.move</field>
        <field name="view_mode">graph,pivot</field>
        <field name="view_id" ref="view_ams_revenue_graph_dashboard"/>
        <field name="domain">[('move_type', '=', 'out_invoice'), ('has_ams_products', '=', True), ('state', '=', 'posted')]</field>
        <field name="context">{
            'search_default_filter_this_year': 1,
            'group_by': ['date:month']
        }</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                📈 Your revenue trends will appear here!
            </p>
            <p>
                Visual analysis of your association's revenue patterns:
                <br/>• Monthly revenue growth
                <br/>• Seasonal trends  
                <br/>• Year-over-year comparison
            </p>
        </field>
    </record>

    <!-- Payment Status Dashboard (Enhanced dashboard-specific action) -->
    <record id="action_ams_payment_status_dashboard" model="ir.actions.act_window">
        <field name="name">💳 Payment Status Dashboard</field>
        <field name="res_model">account.move</field>
        <field name="view_mode">graph,tree</field>
        <field name="view_id" ref="view_ams_payment_status_graph"/>
        <field name="domain">[('move_type', '=', 'out_invoice'), ('has_ams_products', '=', True)]</field>
        <field name="context">{
            'search_default_filter_unpaid': 1,
            'group_by': ['payment_state']
        }</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                💳 Payment tracking dashboard
            </p>
            <p>
                Monitor customer payment status:
                <br/>• Outstanding invoices
                <br/>• Payment completion rates
                <br/>• Follow-up needed
            </p>
        </field>
    </record>

    <!-- Customer Revenue Analysis (Enhanced dashboard-specific action) -->
    <record id="action_ams_customer_revenue_analysis" model="ir.actions.act_window">
        <field name="name">👥 Customer Revenue Analysis</field>
        <field name="res_model">account.move</field>
        <field name="view_mode">pivot,graph</field>
        <field name="view_id" ref="view_ams_customer_revenue_pivot"/>
        <field name="domain">[('move_type', '=', 'out_invoice'), ('has_ams_products', '=', True), ('state', '=', 'posted')]</field>
        <field name="context">{
            'group_by': ['partner_id'],
            'search_default_filter_this_year': 1
        }</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                👥 Customer analysis dashboard
            </p>
            <p>
                Understand your customer revenue patterns:
                <br/>• Top revenue-generating customers
                <br/>• Customer payment history
                <br/>• Membership value analysis
            </p>
        </field>
    </record>

    <!-- =================================================================== -->
    <!-- DASHBOARD SEARCH FILTERS                                           -->
    <!-- =================================================================== -->
    
    <record id="view_ams_dashboard_search" model="ir.ui.view">
        <field name="name">ams.dashboard.search</field>
        <field name="model">account.move</field>
        <field name="arch" type="xml">
            <search string="💰 Revenue &amp; Payments">
                <field name="name" string="Invoice Number"/>
                <field name="partner_id" string="Customer"/>
                <field name="amount_total" string="Amount"/>
                
                <!-- User-friendly date filters -->
                <filter name="filter_this_month" string="📅 This Month" 
                        domain="[('date', '&gt;=', (context_today().replace(day=1)).strftime('%Y-%m-%d')), ('date', '&lt;', ((context_today().replace(day=1) + datetime.timedelta(days=32)).replace(day=1)).strftime('%Y-%m-%d'))]"/>
                <filter name="filter_this_quarter" string="📅 This Quarter" 
                        domain="[('date', '&gt;=', (context_today() - datetime.timedelta(days=90)).strftime('%Y-%m-%d'))]"/>
                <filter name="filter_this_year" string="📅 This Year" 
                        domain="[('date', '&gt;=', context_today().replace(month=1, day=1).strftime('%Y-%m-%d'))]"/>
                
                <!-- Payment status filters -->
                <separator/>
                <filter name="filter_paid" string="✅ Paid" 
                        domain="[('payment_state', '=', 'paid')]"/>
                <filter name="filter_unpaid" string="⏳ Unpaid" 
                        domain="[('payment_state', 'in', ['not_paid', 'partial'])]"/>
                <filter name="filter_overdue" string="⚠️ Overdue" 
                        domain="[('payment_state', 'in', ['not_paid', 'partial']), ('invoice_date_due', '&lt;', context_today())]"/>
                
                <!-- Standard filters -->
                <separator/>
                <filter name="filter_posted" string="📋 Posted" 
                        domain="[('state', '=', 'posted')]"/>
                
                <group expand="0" string="📊 Group By">
                    <filter name="group_by_month" string="📅 Month" 
                            domain="[]" context="{'group_by': 'date:month'}"/>
                    <filter name="group_by_customer" string="👥 Customer" 
                            domain="[]" context="{'group_by': 'partner_id'}"/>
                    <filter name="group_by_payment_state" string="💳 Payment Status" 
                            domain="[]" context="{'group_by': 'payment_state'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- =================================================================== -->
    <!-- MINIMAL MENU STRUCTURE (for external module references)            -->
    <!-- =================================================================== -->
    
    <!-- This menu is required by ams_revenue_recognition module -->
    <!-- It's kept minimal to avoid conflicts with ams_accounting_menu.xml -->
    <menuitem id="menu_ams_accounting"
              name="💰 AMS Accounting"
              sequence="50"/>

</odoo>