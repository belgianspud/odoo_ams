<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <!-- ==============================================
             AMS MODULE CATEGORIES
             ============================================== -->
        
        <!-- Create our own module categories -->
        <record id="module_category_ams_accounting" model="ir.module.category">
            <field name="name">AMS Accounting</field>
            <field name="description">Association Management System Accounting Features</field>
            <field name="sequence">25</field>
        </record>

        <record id="module_category_ams_reporting" model="ir.module.category">
            <field name="name">AMS Reporting</field>
            <field name="description">Association Management System Reports and Analytics</field>
            <field name="sequence">26</field>
        </record>

        <!-- ==============================================
             AMS ACCOUNTING SECURITY GROUPS
             ============================================== -->
        
        <!-- Base AMS Accounting Access -->
        <record id="group_ams_accounting_user" model="res.groups">
            <field name="name">AMS Accounting User</field>
            <field name="category_id" ref="module_category_ams_accounting"/>
            <field name="comment">Basic access to AMS accounting features - can view and create entries</field>
        </record>

        <!-- AMS Accounting Manager -->
        <record id="group_ams_accounting_manager" model="res.groups">
            <field name="name">AMS Accounting Manager</field>
            <field name="category_id" ref="module_category_ams_accounting"/>
            <field name="implied_ids" eval="[(4, ref('group_ams_accounting_user'))]"/>
            <field name="comment">Full access to AMS accounting - can configure accounts, journals, and manage all entries</field>
        </record>

        <!-- AMS Revenue Recognition Specialist -->
        <record id="group_ams_revenue_recognition" model="res.groups">
            <field name="name">AMS Revenue Recognition Specialist</field>
            <field name="category_id" ref="module_category_ams_accounting"/>
            <field name="implied_ids" eval="[(4, ref('group_ams_accounting_user'))]"/>
            <field name="comment">Specialized access for managing revenue recognition schedules and processing</field>
        </record>

        <!-- AMS Financial Reports Access -->
        <record id="group_ams_financial_reports" model="res.groups">
            <field name="name">AMS Financial Reports</field>
            <field name="category_id" ref="module_category_ams_reporting"/>
            <field name="implied_ids" eval="[(4, ref('group_ams_accounting_user'))]"/>
            <field name="comment">Access to financial reports and analytics</field>
        </record>

        <!-- ==============================================
             RECORD RULES - ROW LEVEL SECURITY
             ============================================== -->

        <!-- AMS Account Access Rules -->
        <record id="ams_account_account_user_rule" model="ir.rule">
            <field name="name">AMS Account: User Access</field>
            <field name="model_id" ref="model_ams_account_account"/>
            <field name="domain_force">[('company_id', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('group_ams_accounting_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="ams_account_account_manager_rule" model="ir.rule">
            <field name="name">AMS Account: Manager Full Access</field>
            <field name="model_id" ref="model_ams_account_account"/>
            <field name="domain_force">[('company_id', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('group_ams_accounting_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- AMS Journal Access Rules -->
        <record id="ams_account_journal_user_rule" model="ir.rule">
            <field name="name">AMS Journal: User Access</field>
            <field name="model_id" ref="model_ams_account_journal"/>
            <field name="domain_force">[('company_id', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('group_ams_accounting_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="ams_account_journal_manager_rule" model="ir.rule">
            <field name="name">AMS Journal: Manager Full Access</field>
            <field name="model_id" ref="model_ams_account_journal"/>
            <field name="domain_force">[('company_id', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('group_ams_accounting_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- AMS Journal Entry Access Rules -->
        <record id="ams_account_move_user_rule" model="ir.rule">
            <field name="name">AMS Journal Entry: User Access</field>
            <field name="model_id" ref="model_ams_account_move"/>
            <field name="domain_force">[('company_id', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('group_ams_accounting_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="ams_account_move_manager_rule" model="ir.rule">
            <field name="name">AMS Journal Entry: Manager Full Access</field>
            <field name="model_id" ref="model_ams_account_move"/>
            <field name="domain_force">[('company_id', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('group_ams_accounting_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- AMS Journal Entry Line Access Rules -->
        <record id="ams_account_move_line_user_rule" model="ir.rule">
            <field name="name">AMS Journal Line: User Access</field>
            <field name="model_id" ref="model_ams_account_move_line"/>
            <field name="domain_force">[('company_id', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('group_ams_accounting_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Revenue Recognition Access Rules -->
        <record id="ams_revenue_recognition_user_rule" model="ir.rule">
            <field name="name">AMS Revenue Recognition: User Access</field>
            <field name="model_id" ref="model_ams_revenue_recognition"/>
            <field name="domain_force">[('company_id', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('group_ams_accounting_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="ams_revenue_recognition_specialist_rule" model="ir.rule">
            <field name="name">AMS Revenue Recognition: Specialist Access</field>
            <field name="model_id" ref="model_ams_revenue_recognition"/>
            <field name="domain_force">[('company_id', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('group_ams_revenue_recognition'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="ams_revenue_recognition_manager_rule" model="ir.rule">
            <field name="name">AMS Revenue Recognition: Manager Full Access</field>
            <field name="model_id" ref="model_ams_revenue_recognition"/>
            <field name="domain_force">[('company_id', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('group_ams_accounting_manager'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Revenue Recognition Schedule Access -->
        <record id="ams_revenue_recognition_schedule_user_rule" model="ir.rule">
            <field name="name">AMS Revenue Recognition Schedule: User Access</field>
            <field name="model_id" ref="model_ams_revenue_recognition_schedule"/>
            <field name="domain_force">[('company_id', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('group_ams_accounting_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="ams_revenue_recognition_schedule_specialist_rule" model="ir.rule">
            <field name="name">AMS Revenue Recognition Schedule: Specialist Access</field>
            <field name="model_id" ref="model_ams_revenue_recognition_schedule"/>
            <field name="domain_force">[('company_id', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('group_ams_revenue_recognition'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Subscription Accounting Access -->
        <record id="ams_subscription_accounting_user_rule" model="ir.rule">
            <field name="name">AMS Subscription Accounting: User Access</field>
            <field name="model_id" ref="model_ams_subscription_accounting"/>
            <field name="domain_force">[('company_id', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('group_ams_accounting_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- ==============================================
             AUTOMATION SECURITY
             ============================================== -->

        <!-- Allow system user to create automated entries -->
        <record id="ams_account_move_system_rule" model="ir.rule">
            <field name="name">AMS Journal Entry: System Automation</field>
            <field name="model_id" ref="model_ams_account_move"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('base.group_system'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <record id="ams_revenue_recognition_system_rule" model="ir.rule">
            <field name="name">AMS Revenue Recognition: System Automation</field>
            <field name="model_id" ref="model_ams_revenue_recognition"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('base.group_system'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- ==============================================
             MULTI-COMPANY SECURITY
             ============================================== -->

        <!-- Reconciliation records - company specific -->
        <record id="ams_account_full_reconcile_company_rule" model="ir.rule">
            <field name="name">AMS Full Reconcile: Company Access</field>
            <field name="model_id" ref="model_ams_account_full_reconcile"/>
            <field name="domain_force">[('company_id', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('group_ams_accounting_user'))]"/>
        </record>

        <record id="ams_account_partial_reconcile_company_rule" model="ir.rule">
            <field name="name">AMS Partial Reconcile: Company Access</field>
            <field name="model_id" ref="model_ams_account_partial_reconcile"/>
            <field name="domain_force">[('debit_move_id.company_id', 'in', company_ids)]</field>
            <field name="groups" eval="[(4, ref('group_ams_accounting_user'))]"/>
        </record>

    </data>
</odoo>