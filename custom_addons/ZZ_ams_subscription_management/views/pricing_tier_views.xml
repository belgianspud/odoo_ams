<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<!-- AMS Subscription Pricing Tier List View -->
	<record id="view_ams_subscription_pricing_tier_list" model="ir.ui.view">
		<field name="name">ams.subscription.pricing.tier.list</field>
		<field name="model">ams.subscription.pricing.tier</field>
		<field name="arch" type="xml">
			<list string="Subscription Pricing Tiers" default_order="subscription_product_id,member_type_id,valid_from desc">
				<field name="subscription_product_id"/>
				<field name="member_type_id"/>
				<field name="price" widget="monetary"/>
				<field name="discount_percentage" widget="percentage"/>
				<field name="discount_amount" widget="monetary"/>
				<field name="valid_from"/>
				<field name="valid_to"/>
				<field name="requires_verification"/>
				<field name="is_currently_active"/>
				<field name="currency_id" invisible="1"/>
			</list>
		</field>
	</record>
	<!-- AMS Subscription Pricing Tier Form View -->
	<record id="view_ams_subscription_pricing_tier_form" model="ir.ui.view">
		<field name="name">ams.subscription.pricing.tier.form</field>
		<field name="model">ams.subscription.pricing.tier</field>
		<field name="arch" type="xml">
			<form string="Subscription Pricing Tier">
				<header>
					<button name="action_view_subscription" string="View Subscription" 
                            type="object" class="oe_highlight"/>
					<button name="action_duplicate_tier" string="Duplicate Tier" 
                            type="object"/>
				</header>
				<sheet>
					<div class="oe_button_box" name="button_box">
						<button name="action_view_subscription" 
                                type="object" 
                                class="oe_stat_button" 
                                icon="fa-cube">
							<div class="o_field_widget o_stat_info">
								<span class="o_stat_text">View</span>
								<span class="o_stat_text">Subscription</span>
							</div>
						</button>
					</div>
					<div class="oe_title">
						<h1>
							<field name="display_name" readonly="1"/>
						</h1>
					</div>
					<group>
						<group string="Pricing Information">
							<field name="subscription_product_id" options="{'no_create': True}"/>
							<field name="member_type_id" options="{'no_create': True}"/>
							<field name="currency_id" invisible="1"/>
							<field name="price" widget="monetary"/>
						</group>
						<group string="Discount Analysis">
							<field name="default_subscription_price" widget="monetary" readonly="1"/>
							<field name="discount_amount" widget="monetary" readonly="1"/>
							<field name="discount_percentage" widget="percentage" readonly="1"/>
						</group>
					</group>
					<group string="Validity Period">
						<group>
							<field name="valid_from"/>
							<field name="valid_to"/>
						</group>
						<group>
							<field name="is_currently_active" readonly="1"/>
						</group>
					</group>
					<group string="Verification Requirements">
						<group>
							<field name="requires_verification"/>
						</group>
					</group>
					<group string="Verification Criteria" invisible="not requires_verification">
						<field name="verification_criteria" nolabel="1" 
                               placeholder="Describe the verification requirements for this pricing tier..."/>
					</group>
					<div class="alert alert-info mt16" role="alert">
						<h6>
							<i class="fa fa-info-circle"/> Pricing Tier Information
						</h6>
						<div class="row">
							<div class="col-md-6">
								<p>
									<strong>Member Type:</strong>
									<field name="member_type_code" readonly="1"/>
								</p>
								<p>
									<strong>Subscription:</strong>
									<field name="subscription_name" readonly="1"/>
								</p>
							</div>
							<div class="col-md-6">
								<p>
									<strong>Currently Active:</strong>
									<span t-if="is_currently_active" class="text-success">
										<i class="fa fa-check"/> Yes
                                    
									</span>
									<span t-if="not is_currently_active" class="text-warning">
										<i class="fa fa-clock-o"/> No
                                    
									</span>
								</p>
								<p>
									<strong>Verification Required:</strong>
									<span t-if="requires_verification" class="text-warning">
										<i class="fa fa-exclamation-triangle"/> Yes
                                    
									</span>
									<span t-if="not requires_verification" class="text-success">
										<i class="fa fa-check"/> No
                                    
									</span>
								</p>
							</div>
						</div>
					</div>
				</sheet>
			</form>
		</field>
	</record>
	<!-- AMS Subscription Pricing Tier Kanban View -->
	<record id="view_ams_subscription_pricing_tier_kanban" model="ir.ui.view">
		<field name="name">ams.subscription.pricing.tier.kanban</field>
		<field name="model">ams.subscription.pricing.tier</field>
		<field name="arch" type="xml">
			<kanban default_order="subscription_product_id,member_type_id">
				<field name="subscription_product_id"/>
				<field name="member_type_id"/>
				<field name="price"/>
				<field name="currency_id"/>
				<field name="discount_percentage"/>
				<field name="is_currently_active"/>
				<field name="requires_verification"/>
				<field name="valid_from"/>
				<field name="valid_to"/>
				<templates>
					<t t-name="kanban-box">
						<div class="oe_kanban_card oe_kanban_global_click">
							<div class="o_dropdown_kanban dropdown">
								<a role="button" class="dropdown-toggle o-no-caret btn" data-toggle="dropdown" data-display="static" href="#" aria-label="Dropdown menu" title="Dropdown menu">
									<span class="fa fa-ellipsis-v"/>
								</a>
								<div class="dropdown-menu" role="menu">
									<a t-if="widget.editable" role="menuitem" type="edit" class="dropdown-item">Edit</a>
									<a role="menuitem" type="object" name="action_view_subscription" class="dropdown-item">View Subscription</a>
									<a role="menuitem" type="object" name="action_duplicate_tier" class="dropdown-item">Duplicate Tier</a>
									<div class="dropdown-divider"/>
									<a t-if="widget.deletable" role="menuitem" type="delete" class="dropdown-item">Delete</a>
								</div>
							</div>
							<div class="oe_kanban_content">
								<div class="o_kanban_record_top">
									<div class="o_kanban_record_headings">
										<strong class="o_kanban_record_title">
											<field name="member_type_id"/>
										</strong>
										<div class="o_kanban_record_subtitle text-muted">
											<field name="subscription_product_id"/>
										</div>
									</div>
								</div>
								<div class="o_kanban_record_body">
									<div class="o_kanban_record_pricing">
										<strong class="text-primary">
											<field name="currency_id" invisible="1"/>
											<t t-esc="record.currency_id.value"/>
											<t t-esc="record.price.value"/>
										</strong>
										<t t-if="record.discount_percentage.raw_value > 0">
											<span class="text-success">
                                                (Save 
												<t t-esc="record.discount_percentage.value"/>%)
                                            
											</span>
										</t>
									</div>
									<div class="o_kanban_tags_section mt8">
										<t t-if="record.is_currently_active.raw_value">
											<span class="badge badge-success">Active</span>
										</t>
										<t t-if="!record.is_currently_active.raw_value">
											<span class="badge badge-secondary">Inactive</span>
										</t>
										<t t-if="record.requires_verification.raw_value">
											<span class="badge badge-warning">Verification Required</span>
										</t>
									</div>
								</div>
								<div class="o_kanban_record_bottom">
									<div class="oe_kanban_bottom_left">
										<t t-if="record.valid_from.raw_value">
											<span class="text-muted small">
                                                From: 
												<t t-esc="record.valid_from.value"/>
											</span>
										</t>
									</div>
									<div class="oe_kanban_bottom_right">
										<t t-if="record.valid_to.raw_value">
											<span class="text-muted small">
                                                Until: 
												<t t-esc="record.valid_to.value"/>
											</span>
										</t>
									</div>
								</div>
							</div>
						</div>
					</t>
				</templates>
			</kanban>
		</field>
	</record>
	<!-- AMS Subscription Pricing Tier Search View -->
	<record id="view_ams_subscription_pricing_tier_search" model="ir.ui.view">
		<field name="name">ams.subscription.pricing.tier.search</field>
		<field name="model">ams.subscription.pricing.tier</field>
		<field name="arch" type="xml">
			<search string="Search Pricing Tiers">
				<field name="subscription_product_id"/>
				<field name="member_type_id"/>
				<field name="price"/>
				<!-- Filter by status -->
				<filter string="Currently Active" name="currently_active" 
                        domain="[('is_currently_active', '=', True)]"/>
				<filter string="Requires Verification" name="requires_verification" 
                        domain="[('requires_verification', '=', True)]"/>
				<separator/>
				<!-- Filter by member types -->
				<filter string="Student Pricing" name="student_pricing" 
                        domain="[('member_type_id.code', '=', 'student')]"/>
				<filter string="Individual Pricing" name="individual_pricing" 
                        domain="[('member_type_id.code', '=', 'individual')]"/>
				<filter string="Corporate Pricing" name="corporate_pricing" 
                        domain="[('member_type_id.code', '=', 'corporate')]"/>
				<filter string="Retired Pricing" name="retired_pricing" 
                        domain="[('member_type_id.code', '=', 'retired')]"/>
				<separator/>
				<!-- Filter by discount levels -->
				<filter string="Has Discount" name="has_discount" 
                        domain="[('discount_percentage', '>', 0)]"/>
				<filter string="High Discount (>25%)" name="high_discount" 
                        domain="[('discount_percentage', '>', 25)]"/>
				<filter string="Premium Pricing" name="premium_pricing" 
                        domain="[('discount_percentage', '&lt;', 0)]"/>
				<separator/>
				<!-- Filter by validity -->
				<filter string="Future Start Date" name="future_start" 
                        domain="[('valid_from', '>', current_date)]"/>
				<filter string="Expiring Soon" name="expiring_soon" 
                        domain="[('valid_to', '&lt;=', (context_today() + relativedelta(months=1)).strftime('%Y-%m-%d')), ('valid_to', '!=', False)]"/>
				<separator/>
				<!-- Filter by validity -->
				<filter string="Future Start Date" name="future_start" 
                        domain="[('valid_from', '>', context_today().strftime('%Y-%m-%d'))]"/>
				<filter string="Expires This Year" name="expires_this_year" 
                        domain="[('valid_to', '&lt;=', context_today().replace(month=12, day=31).strftime('%Y-%m-%d')), ('valid_to', '!=', False)]"/>
				<filter string="Has End Date" name="has_end_date" 
                        domain="[('valid_to', '!=', False)]"/>
				<!-- Group by options -->
				<group expand="0" string="Group By">
					<filter string="Subscription Product" name="group_by_subscription" 
                            context="{'group_by': 'subscription_product_id'}"/>
					<filter string="Member Type" name="group_by_member_type" 
                            context="{'group_by': 'member_type_id'}"/>
					<filter string="Active Status" name="group_by_active" 
                            context="{'group_by': 'is_currently_active'}"/>
					<filter string="Currency" name="group_by_currency" 
                            context="{'group_by': 'currency_id'}"/>
				</group>
			</search>
		</field>
	</record>
	<!-- Pricing Tier Actions -->
	<record id="action_ams_subscription_pricing_tier" model="ir.actions.act_window">
		<field name="name">Subscription Pricing Tiers</field>
		<field name="res_model">ams.subscription.pricing.tier</field>
		<field name="view_mode">kanban,list,form</field>
		<field name="context">{'search_default_currently_active': 1}</field>
		<field name="help" type="html">
			<p class="o_view_nocontent_smiling_face">
                Create your first pricing tier
            </p>
			<p>
                Pricing tiers allow you to offer different subscription prices 
                based on member types (Student, Individual, Corporate, etc.).
            </p>
			<p>
                Set up discounted rates for students, special pricing for corporate 
                members, or promotional rates with validity periods.
            </p>
		</field>
	</record>
	<!-- Active Pricing Tiers Action -->
	<record id="action_active_pricing_tiers" model="ir.actions.act_window">
		<field name="name">Active Pricing Tiers</field>
		<field name="res_model">ams.subscription.pricing.tier</field>
		<field name="view_mode">kanban,list,form</field>
		<field name="domain">[('is_currently_active', '=', True)]</field>
		<field name="context">{'search_default_currently_active': 1}</field>
	</record>
	<!-- Pricing Tiers Requiring Verification Action -->
	<record id="action_verification_pricing_tiers" model="ir.actions.act_window">
		<field name="name">Pricing Tiers Requiring Verification</field>
		<field name="res_model">ams.subscription.pricing.tier</field>
		<field name="view_mode">list,form</field>
		<field name="domain">[('requires_verification', '=', True)]</field>
		<field name="context">{'search_default_requires_verification': 1}</field>
	</record>
	<!-- Student Pricing Tiers Action -->
	<record id="action_student_pricing_tiers" model="ir.actions.act_window">
		<field name="name">Student Pricing Tiers</field>
		<field name="res_model">ams.subscription.pricing.tier</field>
		<field name="view_mode">kanban,list,form</field>
		<field name="domain">[('member_type_id.code', '=', 'student')]</field>
		<field name="context">{'search_default_student_pricing': 1}</field>
	</record>
	<!-- Menu items for Pricing Tiers -->
	<menuitem id="menu_subscription_pricing_tiers" 
              name="Pricing Tiers" 
              parent="ams_subscription_management.menu_subscription_product_management"
              action="action_ams_subscription_pricing_tier" 
              sequence="40"/>
	<menuitem id="menu_active_pricing_tiers" 
              name="Active Tiers" 
              parent="menu_subscription_pricing_tiers"
              action="action_active_pricing_tiers" 
              sequence="10"/>
	<menuitem id="menu_verification_pricing_tiers" 
              name="Verification Required" 
              parent="menu_subscription_pricing_tiers"
              action="action_verification_pricing_tiers" 
              sequence="20"/>
	<menuitem id="menu_student_pricing_tiers" 
              name="Student Pricing" 
              parent="menu_subscription_pricing_tiers"
              action="action_student_pricing_tiers" 
              sequence="30"/>
</odoo>