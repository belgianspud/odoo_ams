<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Cron Jobs for Subscription Automation -->
    
    <!-- Daily billing check -->
    <record id="cron_subscription_billing" model="ir.cron">
        <field name="name">Subscription: Process Billing</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="state">code</field>
        <field name="code">model._cron_process_billing()</field>
        <field name="interval_number">1</field>
        <field name="interval_type">days</field>
        <field name="active" eval="True"/>
    </record>

    <!-- Check trial expiration -->
    <record id="cron_subscription_trial_expiry" model="ir.cron">
        <field name="name">Subscription: Check Trial Expiry</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="state">code</field>
        <field name="code">model._cron_check_trial_expiry()</field>
        <field name="interval_number">1</field>
        <field name="interval_type">days</field>
        <field name="active" eval="True"/>
    </record>

    <!-- Check subscription expiration -->
    <record id="cron_subscription_expiry" model="ir.cron">
        <field name="name">Subscription: Check Expiry</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="state">code</field>
        <field name="code">model._cron_check_expiry()</field>
        <field name="interval_number">1</field>
        <field name="interval_type">days</field>
        <field name="active" eval="True"/>
    </record>

    <!-- Process auto-renewals -->
    <record id="cron_subscription_auto_renew" model="ir.cron">
        <field name="name">Subscription: Auto Renew</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="state">code</field>
        <field name="code">model._cron_auto_renew()</field>
        <field name="interval_number">1</field>
        <field name="interval_type">days</field>
        <field name="active" eval="True"/>
    </record>

    <!-- Send billing reminders -->
    <record id="cron_subscription_billing_reminders" model="ir.cron">
        <field name="name">Subscription: Billing Reminders</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="state">code</field>
        <field name="code">model._cron_send_billing_reminders()</field>
        <field name="interval_number">1</field>
        <field name="interval_type">days</field>
        <field name="active" eval="True"/>
    </record>

    <!-- Update usage metrics -->
    <record id="cron_subscription_usage_update" model="ir.cron">
        <field name="name">Subscription: Update Usage Metrics</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="state">code</field>
        <field name="code">model._cron_update_usage_metrics()</field>
        <field name="interval_number">1</field>
        <field name="interval_type">hours</field>
        <field name="active" eval="True"/>
    </record>

    <!-- Retry failed payments -->
    <record id="cron_subscription_retry_payments" model="ir.cron">
        <field name="name">Subscription: Retry Failed Payments</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="state">code</field>
        <field name="code">model._cron_retry_failed_payments()</field>
        <field name="interval_number">1</field>
        <field name="interval_type">days</field>
        <field name="active" eval="True"/>
    </record>

    <!-- NEW: Check renewals and send reminders -->
    <record id="cron_subscription_check_renewals" model="ir.cron">
        <field name="name">Subscription: Check Renewals</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="state">code</field>
        <field name="code">model._cron_check_renewals()</field>
        <field name="interval_number">1</field>
        <field name="interval_type">days</field>
        <field name="active" eval="True"/>
        <field name="priority">15</field>
    </record>

    <!-- Email Templates -->
    
    <!-- Welcome email for new subscriptions -->
    <record id="email_template_subscription_welcome" model="mail.template">
        <field name="name">Subscription: Welcome Email</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="subject">Welcome to {{ object.plan_id.name }}!</field>
        <field name="email_from">{{ (object.company_id.email or user.email) }}</field>
        <field name="email_to">{{ object.partner_id.email }}</field>
        <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px; font-family: Arial, sans-serif;">
    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 40px; text-align: center;">
        <h1 style="color: white; margin: 0;">Welcome to {{ object.plan_id.name }}!</h1>
    </div>
    
    <div style="padding: 30px; background: #f8f9fa;">
        <p style="font-size: 16px;">Dear {{ object.partner_id.name }},</p>
        
        <p style="font-size: 16px;">Thank you for subscribing! Your subscription has been activated and you can start enjoying your benefits immediately.</p>
        
        <div style="background: white; border-radius: 8px; padding: 20px; margin: 20px 0;">
            <h3 style="margin-top: 0; color: #667eea;">Subscription Details:</h3>
            <table style="width: 100%; font-size: 14px;">
                <tr>
                    <td style="padding: 8px 0;"><strong>Plan:</strong></td>
                    <td style="padding: 8px 0;">{{ object.plan_id.name }}</td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Subscription ID:</strong></td>
                    <td style="padding: 8px 0;">{{ object.name }}</td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Start Date:</strong></td>
                    <td style="padding: 8px 0;">{{ object.date_start }}</td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Price:</strong></td>
                    <td style="padding: 8px 0;">{{ object.price }} {{ object.currency_id.symbol }} / {{ object.plan_id.billing_period }}</td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Next Billing Date:</strong></td>
                    <td style="padding: 8px 0;">{{ object.next_billing_date }}</td>
                </tr>
            </table>
        </div>
        
        <p style="font-size: 16px;">You can manage your subscription and view your usage at any time by logging into your customer portal.</p>
        
        <div style="text-align: center; margin: 30px 0;">
            <a href="/my/subscriptions/{{ object.id }}" style="background: #667eea; color: white; padding: 12px 30px; text-decoration: none; border-radius: 5px; display: inline-block;">View My Subscription</a>
        </div>
        
        <p style="font-size: 16px;">Thank you for choosing our service!</p>
        
        <p style="font-size: 14px; color: #6c757d;">Best regards,<br/>{{ user.name }}</p>
    </div>
</div>
        </field>
    </record>

    <!-- Billing reminder email -->
    <record id="email_template_subscription_billing_reminder" model="mail.template">
        <field name="name">Subscription: Billing Reminder</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="subject">Upcoming billing for {{ object.plan_id.name }}</field>
        <field name="email_from">{{ (object.company_id.email or user.email) }}</field>
        <field name="email_to">{{ object.partner_id.email }}</field>
        <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px; font-family: Arial, sans-serif;">
    <div style="background: #17a2b8; padding: 30px; text-align: center;">
        <h2 style="color: white; margin: 0;">Upcoming Billing Reminder</h2>
    </div>
    
    <div style="padding: 30px; background: #f8f9fa;">
        <p style="font-size: 16px;">Dear {{ object.partner_id.name }},</p>
        
        <p style="font-size: 16px;">This is a friendly reminder that your subscription billing is coming up soon.</p>
        
        <div style="background: white; border-left: 4px solid #17a2b8; padding: 20px; margin: 20px 0;">
            <h3 style="margin-top: 0; color: #17a2b8;">Billing Information:</h3>
            <table style="width: 100%; font-size: 14px;">
                <tr>
                    <td style="padding: 8px 0;"><strong>Plan:</strong></td>
                    <td style="padding: 8px 0;">{{ object.plan_id.name }}</td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Amount:</strong></td>
                    <td style="padding: 8px 0; font-size: 18px; color: #17a2b8;"><strong>{{ object.price }} {{ object.currency_id.symbol }}</strong></td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Billing Date:</strong></td>
                    <td style="padding: 8px 0;">{{ object.next_billing_date }}</td>
                </tr>
            </table>
        </div>
        
        <p style="font-size: 16px;">Please ensure your payment method is up to date to avoid any service interruption.</p>
        
        <div style="text-align: center; margin: 30px 0;">
            <a href="/my/subscriptions/{{ object.id }}" style="background: #17a2b8; color: white; padding: 12px 30px; text-decoration: none; border-radius: 5px; display: inline-block;">Manage Payment Method</a>
        </div>
        
        <p style="font-size: 14px; color: #6c757d;">Best regards,<br/>{{ user.name }}</p>
    </div>
</div>
        </field>
    </record>

    <!-- Trial expiry reminder -->
    <record id="email_template_subscription_trial_expiry" model="mail.template">
        <field name="name">Subscription: Trial Expiry Reminder</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="subject">Your trial period is ending soon</field>
        <field name="email_from">{{ (object.company_id.email or user.email) }}</field>
        <field name="email_to">{{ object.partner_id.email }}</field>
        <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px; font-family: Arial, sans-serif;">
    <div style="background: #ffc107; padding: 30px; text-align: center;">
        <h2 style="color: #333; margin: 0;">Your Trial is Ending Soon</h2>
    </div>
    
    <div style="padding: 30px; background: #f8f9fa;">
        <p style="font-size: 16px;">Dear {{ object.partner_id.name }},</p>
        
        <p style="font-size: 16px;">Your trial period for <strong>{{ object.plan_id.name }}</strong> is ending soon.</p>
        
        <div style="background: white; border-left: 4px solid #ffc107; padding: 20px; margin: 20px 0;">
            <h3 style="margin-top: 0; color: #ffc107;">Trial Information:</h3>
            <table style="width: 100%; font-size: 14px;">
                <tr>
                    <td style="padding: 8px 0;"><strong>Plan:</strong></td>
                    <td style="padding: 8px 0;">{{ object.plan_id.name }}</td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Trial End Date:</strong></td>
                    <td style="padding: 8px 0; font-size: 18px; color: #ffc107;"><strong>{{ object.trial_end_date }}</strong></td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Regular Price:</strong></td>
                    <td style="padding: 8px 0;">{{ object.price }} {{ object.currency_id.symbol }} / {{ object.plan_id.billing_period }}</td>
                </tr>
            </table>
        </div>
        
        <p style="font-size: 16px;">To continue enjoying our service without interruption, please ensure your payment method is set up.</p>
        
        <div style="text-align: center; margin: 30px 0;">
            <a href="/my/subscriptions/{{ object.id }}" style="background: #ffc107; color: #333; padding: 12px 30px; text-decoration: none; border-radius: 5px; display: inline-block; font-weight: bold;">Manage Subscription</a>
        </div>
        
        <p style="font-size: 14px; color: #6c757d;">Best regards,<br/>{{ user.name }}</p>
    </div>
</div>
        </field>
    </record>

    <!-- Cancellation confirmation -->
    <record id="email_template_subscription_cancelled" model="mail.template">
        <field name="name">Subscription: Cancellation Confirmation</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="subject">Subscription cancelled: {{ object.plan_id.name }}</field>
        <field name="email_from">{{ (object.company_id.email or user.email) }}</field>
        <field name="email_to">{{ object.partner_id.email }}</field>
        <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px; font-family: Arial, sans-serif;">
    <div style="background: #6c757d; padding: 30px; text-align: center;">
        <h2 style="color: white; margin: 0;">Subscription Cancelled</h2>
    </div>
    
    <div style="padding: 30px; background: #f8f9fa;">
        <p style="font-size: 16px;">Dear {{ object.partner_id.name }},</p>
        
        <p style="font-size: 16px;">We're sorry to see you go! Your subscription has been cancelled as requested.</p>
        
        <div style="background: white; border-left: 4px solid #6c757d; padding: 20px; margin: 20px 0;">
            <h3 style="margin-top: 0; color: #6c757d;">Cancellation Details:</h3>
            <table style="width: 100%; font-size: 14px;">
                <tr>
                    <td style="padding: 8px 0;"><strong>Plan:</strong></td>
                    <td style="padding: 8px 0;">{{ object.plan_id.name }}</td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Subscription ID:</strong></td>
                    <td style="padding: 8px 0;">{{ object.name }}</td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Cancellation Date:</strong></td>
                    <td style="padding: 8px 0;">{{ object.date_end }}</td>
                </tr>
            </table>
        </div>
        
        <p style="font-size: 16px;">You will continue to have access to the service until your current billing period ends.</p>
        
        <p style="font-size: 16px;">If you change your mind, you can reactivate your subscription anytime.</p>
        
        <div style="text-align: center; margin: 30px 0;">
            <a href="/my/subscriptions" style="background: #667eea; color: white; padding: 12px 30px; text-decoration: none; border-radius: 5px; display: inline-block;">View My Subscriptions</a>
        </div>
        
        <p style="font-size: 16px;">Thank you for using our service!</p>
        
        <p style="font-size: 14px; color: #6c757d;">Best regards,<br/>{{ user.name }}</p>
    </div>
</div>
        </field>
    </record>

    <!-- Payment Failed - Soft Dunning -->
    <record id="email_template_payment_failed_soft" model="mail.template">
        <field name="name">Subscription: Payment Failed (Soft Dunning)</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="subject">Payment issue with your {{ object.plan_id.name }} subscription</field>
        <field name="email_from">{{ (object.company_id.email or user.email) }}</field>
        <field name="email_to">{{ object.partner_id.email }}</field>
        <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px; font-family: Arial, sans-serif;">
    <div style="background: #ffc107; padding: 30px; text-align: center;">
        <h2 style="color: #333; margin: 0;">‚ö†Ô∏è Payment Issue</h2>
    </div>
    
    <div style="padding: 30px; background: #f8f9fa;">
        <p style="font-size: 16px;">Hi {{ object.partner_id.name }},</p>
        
        <p style="font-size: 16px;">We were unable to process your payment for <strong>{{ object.plan_id.name }}</strong>.</p>
        
        <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 20px; margin: 20px 0; border-radius: 4px;">
            <h3 style="margin-top: 0; color: #856404;">Payment Details:</h3>
            <table style="width: 100%; font-size: 14px;">
                <tr>
                    <td style="padding: 8px 0;"><strong>Plan:</strong></td>
                    <td style="padding: 8px 0;">{{ object.plan_id.name }}</td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Amount:</strong></td>
                    <td style="padding: 8px 0; font-size: 18px; color: #856404;"><strong>{{ object.price }} {{ object.currency_id.symbol }}</strong></td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Retry Attempt:</strong></td>
                    <td style="padding: 8px 0;">{{ object.payment_retry_count }} of 3</td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Next Retry:</strong></td>
                    <td style="padding: 8px 0;">{{ object.payment_retry_date }}</td>
                </tr>
            </table>
        </div>
        
        <p style="font-size: 16px;">This can happen for various reasons such as:</p>
        <ul style="font-size: 14px; color: #6c757d;">
            <li>Insufficient funds</li>
            <li>Expired card</li>
            <li>Card limit reached</li>
            <li>Security restrictions</li>
        </ul>
        
        <p style="font-size: 16px;"><strong>Please update your payment method to continue your service without interruption.</strong></p>
        
        <p style="font-size: 14px; color: #6c757d;">We'll automatically retry the payment in 3 days.</p>
        
        <div style="text-align: center; margin: 30px 0;">
            <a href="/my/subscriptions/{{ object.id }}" style="background: #ffc107; color: #333; padding: 15px 40px; text-decoration: none; border-radius: 5px; display: inline-block; font-weight: bold; font-size: 16px;">Update Payment Method</a>
        </div>
        
        <p style="font-size: 14px; color: #6c757d;">If you have any questions, please don't hesitate to contact us.</p>
        
        <p style="font-size: 14px; color: #6c757d;">Best regards,<br/>{{ user.name }}</p>
    </div>
</div>
        </field>
    </record>

    <!-- Payment Failed - Hard Dunning -->
    <record id="email_template_payment_failed_hard" model="mail.template">
        <field name="name">Subscription: Payment Failed (Hard Dunning)</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="subject">URGENT: Payment issue with your subscription - Action Required</field>
        <field name="email_from">{{ (object.company_id.email or user.email) }}</field>
        <field name="email_to">{{ object.partner_id.email }}</field>
        <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px; font-family: Arial, sans-serif;">
    <div style="background: #dc3545; padding: 30px; text-align: center;">
        <h2 style="color: white; margin: 0;">üö® URGENT: Action Required</h2>
    </div>
    
    <div style="padding: 30px; background: #f8f9fa;">
        <p style="font-size: 16px;">Hi {{ object.partner_id.name }},</p>
        
        <p style="font-size: 18px; color: #dc3545;"><strong>Your subscription service is at risk of suspension.</strong></p>
        
        <p style="font-size: 16px;">We've attempted to charge your payment method <strong>{{ object.payment_retry_count }} times</strong> without success for your <strong>{{ object.plan_id.name }}</strong> subscription.</p>
        
        <div style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; margin: 20px 0; border-radius: 4px;">
            <h3 style="margin-top: 0; color: #721c24;">‚ö†Ô∏è Immediate Action Required:</h3>
            <table style="width: 100%; font-size: 14px;">
                <tr>
                    <td style="padding: 8px 0;"><strong>Outstanding Amount:</strong></td>
                    <td style="padding: 8px 0; font-size: 20px; color: #dc3545;"><strong>{{ object.price }} {{ object.currency_id.symbol }}</strong></td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Payment Attempts:</strong></td>
                    <td style="padding: 8px 0;">{{ object.payment_retry_count }} of 3</td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Final Retry Date:</strong></td>
                    <td style="padding: 8px 0;">{{ object.payment_retry_date }}</td>
                </tr>
            </table>
        </div>
        
        <div style="background: #fff3cd; border: 1px solid #ffc107; padding: 15px; margin: 20px 0; border-radius: 4px;">
            <p style="font-size: 14px; margin: 0; color: #856404;"><strong>‚ö†Ô∏è Warning:</strong> If payment is not received by {{ object.payment_retry_date }}, your subscription will be automatically suspended.</p>
        </div>
        
        <p style="font-size: 16px;"><strong>Please update your payment information immediately to avoid service interruption.</strong></p>
        
        <div style="text-align: center; margin: 30px 0;">
            <a href="/my/subscriptions/{{ object.id }}" style="background: #dc3545; color: white; padding: 18px 50px; text-decoration: none; border-radius: 5px; display: inline-block; font-weight: bold; font-size: 18px;">Update Payment Now</a>
        </div>
        
        <p style="font-size: 14px; color: #6c757d;">If you're experiencing issues or would like to discuss your account, please contact us immediately.</p>
        
        <p style="font-size: 14px; color: #6c757d;">Best regards,<br/>{{ user.name }}</p>
    </div>
</div>
        </field>
    </record>

    <!-- Payment Failed - Final Notice -->
    <record id="email_template_payment_failed_final" model="mail.template">
        <field name="name">Subscription: Payment Failed (Final Notice)</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="subject">FINAL NOTICE: Your subscription has been suspended</field>
        <field name="email_from">{{ (object.company_id.email or user.email) }}</field>
        <field name="email_to">{{ object.partner_id.email }}</field>
        <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px; font-family: Arial, sans-serif;">
    <div style="background: #343a40; padding: 30px; text-align: center;">
        <h2 style="color: white; margin: 0;">üîí Subscription Suspended</h2>
    </div>
    
    <div style="padding: 30px; background: #f8f9fa;">
        <p style="font-size: 16px;">Hi {{ object.partner_id.name }},</p>
        
        <p style="font-size: 18px; color: #dc3545;"><strong>Your {{ object.plan_id.name }} subscription has been suspended due to failed payment.</strong></p>
        
        <p style="font-size: 16px;">Despite multiple attempts to process your payment, we were unable to successfully charge your payment method.</p>
        
        <div style="background: #e2e3e5; border-left: 4px solid #343a40; padding: 20px; margin: 20px 0; border-radius: 4px;">
            <h3 style="margin-top: 0; color: #343a40;">Account Status:</h3>
            <table style="width: 100%; font-size: 14px;">
                <tr>
                    <td style="padding: 8px 0;"><strong>Status:</strong></td>
                    <td style="padding: 8px 0; color: #dc3545;"><strong>SUSPENDED</strong></td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Outstanding Amount:</strong></td>
                    <td style="padding: 8px 0; font-size: 18px;"><strong>{{ object.price }} {{ object.currency_id.symbol }}</strong></td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Payment Attempts:</strong></td>
                    <td style="padding: 8px 0;">{{ object.payment_retry_count }}</td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Suspension Date:</strong></td>
                    <td style="padding: 8px 0;">{{ now().strftime('%Y-%m-%d') }}</td>
                </tr>
            </table>
        </div>
        
        <div style="background: #d1ecf1; border: 1px solid #0c5460; padding: 15px; margin: 20px 0; border-radius: 4px;">
            <p style="font-size: 14px; margin: 0; color: #0c5460;"><strong>‚ÑπÔ∏è Good News:</strong> Your subscription can be reactivated immediately once payment is received. Your data and settings are safe.</p>
        </div>
        
        <p style="font-size: 16px;"><strong>To reactivate your subscription:</strong></p>
        <ol style="font-size: 14px;">
            <li>Update your payment method</li>
            <li>Clear the outstanding balance</li>
            <li>Your service will be restored immediately</li>
        </ol>
        
        <div style="text-align: center; margin: 30px 0;">
            <a href="/my/subscriptions/{{ object.id }}" style="background: #28a745; color: white; padding: 18px 50px; text-decoration: none; border-radius: 5px; display: inline-block; font-weight: bold; font-size: 18px;">Reactivate My Subscription</a>
        </div>
        
        <p style="font-size: 14px; color: #6c757d;">If you have questions or need assistance, please contact our support team. We're here to help!</p>
        
        <p style="font-size: 14px; color: #6c757d;">Best regards,<br/>{{ user.name }}</p>
    </div>
</div>
        </field>
    </record>

    <!-- Subscription Renewal Reminder - NEW -->
    <record id="email_template_subscription_renewal_reminder" model="mail.template">
        <field name="name">Subscription: Renewal Reminder</field>
        <field name="model_id" ref="model_subscription_subscription"/>
        <field name="subject">Time to Renew: {{ object.plan_id.name }}</field>
        <field name="email_from">{{ (object.company_id.email or user.email) }}</field>
        <field name="email_to">{{ object.partner_id.email }}</field>
        <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px; font-family: Arial, sans-serif;">
    <div style="background: #667eea; padding: 30px; text-align: center;">
        <h2 style="color: white; margin: 0;">üîÑ Renewal Time!</h2>
    </div>
    
    <div style="padding: 30px; background: #f8f9fa;">
        <p style="font-size: 16px;">Hi {{ object.partner_id.name }},</p>
        
        <p style="font-size: 16px;">Your subscription to <strong>{{ object.plan_id.name }}</strong> is coming up for renewal.</p>
        
        <div style="background: white; border-left: 4px solid #667eea; padding: 20px; margin: 20px 0;">
            <h3 style="margin-top: 0; color: #667eea;">Subscription Details:</h3>
            <table style="width: 100%; font-size: 14px;">
                <tr>
                    <td style="padding: 8px 0;"><strong>Plan:</strong></td>
                    <td style="padding: 8px 0;">{{ object.plan_id.name }}</td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Subscription ID:</strong></td>
                    <td style="padding: 8px 0;">{{ object.name }}</td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Current End Date:</strong></td>
                    <td style="padding: 8px 0; font-size: 18px; color: #667eea;"><strong>{{ object.date_end }}</strong></td>
                </tr>
                <tr>
                    <td style="padding: 8px 0;"><strong>Renewal Price:</strong></td>
                    <td style="padding: 8px 0;">{{ object.price }} {{ object.currency_id.symbol }}</td>
                </tr>
                <tr t-if="object.plan_id.billing_type == 'calendar'">
                    <td style="padding: 8px 0;"><strong>Billing Type:</strong></td>
                    <td style="padding: 8px 0;">Calendar-based (aligned to calendar periods)</td>
                </tr>
            </table>
        </div>
        
        <p style="font-size: 16px;">To continue enjoying uninterrupted service, please renew your subscription.</p>
        
        <t t-if="object.plan_id.auto_renew">
            <div style="background: #d4edda; border: 1px solid #c3e6cb; padding: 15px; margin: 20px 0; border-radius: 4px;">
                <p style="font-size: 14px; margin: 0; color: #155724;">
                    <strong>‚úì Auto-renewal is enabled.</strong> Your subscription will automatically renew unless you choose to cancel.
                </p>
            </div>
        </t>
        
        <div style="text-align: center; margin: 30px 0;">
            <a href="/my/subscriptions/{{ object.id }}" style="background: #667eea; color: white; padding: 15px 40px; text-decoration: none; border-radius: 5px; display: inline-block; font-weight: bold; font-size: 16px;">Manage Subscription</a>
        </div>
        
        <p style="font-size: 14px; color: #6c757d;">If you have any questions or would like to discuss your renewal, please don't hesitate to contact us.</p>
        
        <p style="font-size: 14px; color: #6c757d;">Best regards,<br/>{{ user.name }}</p>
    </div>
</div>
        </field>
    </record>

</odoo>