<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Event Form View Inherit - Add Pricing Section -->
    <record id="view_event_form_pricing" model="ir.ui.view">
        <field name="name">event.event.form.pricing</field>
        <field name="model">event.event</field>
        <field name="inherit_id" ref="event.view_event_form"/>
        <field name="arch" type="xml">
            <xpath expr="//notebook" position="inside">
                <page string="Member Pricing">
                    <group>
                        <group name="member_pricing" string="Member Pricing">
                            <field name="use_member_pricing"/>
                            <field name="member_price" attrs="{'invisible': [('use_member_pricing', '=', False)]}"/>
                            <field name="non_member_price" attrs="{'invisible': [('use_member_pricing', '=', False)]}"/>
                            <field name="member_discount_percent" attrs="{'invisible': [('use_member_pricing', '=', False)]}" readonly="1"/>
                        </group>
                        <group name="early_bird" string="Early Bird Pricing">
                            <field name="use_early_bird"/>
                            <field name="early_bird_deadline" attrs="{'invisible': [('use_early_bird', '=', False)], 'required': [('use_early_bird', '=', True)]}"/>
                            <field name="early_bird_member_price" attrs="{'invisible': [('use_early_bird', '=', False)]}"/>
                            <field name="early_bird_non_member_price" attrs="{'invisible': [('use_early_bird', '=', False)]}"/>
                        </group>
                    </group>
                    <group name="statistics" string="Registration Statistics" attrs="{'invisible': [('use_member_pricing', '=', False)]}">
                        <group>
                            <button name="action_view_member_registrations" string="Member Registrations" type="object" class="oe_link">
                                <field name="member_registrations" widget="statinfo"/>
                            </button>
                            <button name="action_view_non_member_registrations" string="Non-Member Registrations" type="object" class="oe_link">
                                <field name="non_member_registrations" widget="statinfo"/>
                            </button>
                        </group>
                        <group>
                            <field name="total_member_revenue"/>
                            <field name="total_non_member_revenue"/>
                        </group>
                    </group>
                </page>
            </xpath>
        </field>
    </record>

    <!-- Event Registration Tree View Inherit -->
    <record id="view_event_registration_tree_pricing" model="ir.ui.view">
        <field name="name">event.registration.tree.pricing</field>
        <field name="model">event.registration</field>
        <field name="inherit_id" ref="event.view_event_registration_tree"/>
        <field name="arch" type="xml">
            <field name="partner_id" position="after">
                <field name="is_member"/>
                <field name="membership_level_id"/>
                <field name="chapter_id"/>
            </field>
            <field name="state" position="before">
                <field name="final_price"/>
                <field name="is_early_bird"/>
            </field>
        </field>
    </record>

    <!-- Event Registration Form View Inherit -->
    <record id="view_event_registration_form_pricing" model="ir.ui.view">
        <field name="name">event.registration.form.pricing</field>
        <field name="model">event.registration</field>
        <field name="inherit_id" ref="event.view_event_registration_form"/>
        <field name="arch" type="xml">
            <xpath expr="//notebook" position="inside">
                <page string="Membership &amp; Pricing">
                    <group>
                        <group name="membership_info" string="Membership Information">
                            <field name="is_member"/>
                            <field name="membership_level_id"/>
                            <field name="chapter_id"/>
                        </group>
                        <group name="pricing_info" string="Pricing Information">
                            <field name="is_early_bird"/>
                            <field name="base_price"/>
                            <field name="member_discount"/>
                            <field name="level_discount"/>
                            <field name="final_price"/>
                        </group>
                    </group>
                </page>
            </xpath>
        </field>
    </record>

    <!-- Event Registration Search View Inherit -->
    <record id="view_event_registration_search_pricing" model="ir.ui.view">
        <field name="name">event.registration.search.pricing</field>
        <field name="model">event.registration</field>
        <field name="inherit_id" ref="event.view_registration_search"/>
        <field name="arch" type="xml">
            <field name="event_id" position="after">
                <field name="is_member"/>
                <field name="membership_level_id"/>
                <field name="chapter_id"/>
            </field>
            <xpath expr="//filter[@name='confirmed']" position="after">
                <filter string="Members" name="members" domain="[('is_member', '=', True)]"/>
                <filter string="Non-Members" name="non_members" domain="[('is_member', '=', False)]"/>
                <filter string="Early Bird" name="early_bird" domain="[('is_early_bird', '=', True)]"/>
            </xpath>
            <xpath expr="//group[@expand='0']" position="inside">
                <filter string="Membership Status" name="group_membership" context="{'group_by': 'is_member'}"/>
                <filter string="Membership Level" name="group_level" context="{'group_by': 'membership_level_id'}"/>
                <filter string="Chapter" name="group_chapter" context="{'group_by': 'chapter_id'}"/>
            </xpath>
        </field>
    </record>

    <!-- Event Ticket Form View Inherit -->
    <record id="view_event_ticket_form_pricing" model="ir.ui.view">
        <field name="name">event.event.ticket.form.pricing</field>
        <field name="model">event.event.ticket</field>
        <field name="inherit_id" ref="event.event_ticket_view_form"/>
        <field name="arch" type="xml">
            <field name="price" position="after">
                <field name="use_member_pricing"/>
                <field name="member_price" attrs="{'invisible': [('use_member_pricing', '=', False)]}"/>
            </field>
        </field>
    </record>

    <!-- Partner Form View Inherit - Add Event Statistics -->
    <record id="view_partner_form_event_stats" model="ir.ui.view">
        <field name="name">res.partner.form.event.stats</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="membership_chapter.view_partner_form_chapter"/>
        <field name="arch" type="xml">
            <xpath expr="//group[1]/group[2]" position="inside">
                <field name="events_attended_count"/>
                <field name="total_event_spending"/>
            </xpath>
            <xpath expr="//page[@string='Subscriptions']" position="after">
                <page string="Event History">
                    <field name="event_registration_ids">
                        <tree>
                            <field name="event_id"/>
                            <field name="date_open"/>
                            <field name="is_member"/>
                            <field name="membership_level_id"/>
                            <field name="final_price"/>
                            <field name="state"/>
                        </tree>
                    </field>
                </page>
            </xpath>
        </field>
    </record>

    <!-- Event List View with Pricing Info -->
    <record id="view_event_tree_pricing" model="ir.ui.view">
        <field name="name">event.event.tree.pricing</field>
        <field name="model">event.event</field>
        <field name="inherit_id" ref="event.view_event_tree"/>
        <field name="arch" type="xml">
            <field name="seats_available" position="after">
                <field name="use_member_pricing"/>
                <field name="member_price" attrs="{'invisible': [('use_member_pricing', '=', False)]}"/>
                <field name="non_member_price" attrs="{'invisible': [('use_member_pricing', '=', False)]}"/>
            </field>
        </field>
    </record>

    <!-- Event Kanban View with Member Stats -->
    <record id="view_event_kanban_pricing" model="ir.ui.view">
        <field name="name">event.event.kanban.pricing</field>
        <field name="model">event.event</field>
        <field name="inherit_id" ref="event.view_event_kanban"/>
        <field name="arch" type="xml">
            <xpath expr="//div[hasclass('o_kanban_record_bottom')]" position="inside">
                <div class="oe_kanban_bottom_right" t-if="record.use_member_pricing.raw_value">
                    <span class="badge badge-pill badge-info">
                        <t t-esc="record.member_registrations.value"/> members
                    </span>
                    <span class="badge badge-pill badge-secondary">
                        <t t-esc="record.non_member_registrations.value"/> non-members
                    </span>
                </div>
            </xpath>
        </field>
    </record>

</odoo>