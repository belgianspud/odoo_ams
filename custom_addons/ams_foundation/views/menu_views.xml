<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        
        <!-- Main AMS Menu -->
        <menuitem id="menu_ams_main"
            name="Association Management"
            sequence="5"
            groups="group_ams_member"/>

        <!-- Configuration Menu -->
        <menuitem id="menu_ams_configuration"
            name="Configuration"
            parent="menu_ams_main"
            sequence="100"
            groups="group_ams_manager"/>

        <!-- Members Menu -->
        <menuitem id="menu_ams_members"
            name="Members"
            parent="menu_ams_main"
            sequence="10"
            groups="group_ams_staff"/>

        <!-- Member Directory -->
        <menuitem id="menu_ams_member_directory"
            name="Member Directory"
            parent="menu_ams_members"
            action="action_partner_member_directory"
            sequence="10"
            groups="group_ams_staff"/>

        <!-- Member Types Configuration -->
        <menuitem id="menu_ams_member_types"
            name="Member Types"
            parent="menu_ams_configuration"
            action="action_ams_member_type"
            sequence="10"
            groups="group_ams_manager"/>

        <!-- AMS Settings -->
        <menuitem id="menu_ams_settings"
            name="AMS Settings"
            parent="menu_ams_configuration"
            action="action_ams_settings"
            sequence="5"
            groups="group_ams_admin"/>

        <!-- Engagement Rules -->
        <menuitem id="menu_ams_engagement_rules"
            name="Engagement Rules"
            parent="menu_ams_configuration"
            action="action_ams_engagement_rule"
            sequence="20"
            groups="group_ams_manager"/>

        <!-- Tools Menu -->
        <menuitem id="menu_ams_tools"
            name="Tools"
            parent="menu_ams_main"
            sequence="90"
            groups="group_ams_staff"/>

        <!-- Portal User Wizard -->
        <menuitem id="menu_ams_portal_user_wizard"
            name="Create Portal Users"
            parent="menu_ams_tools"
            action="action_portal_user_wizard"
            sequence="10"
            groups="group_ams_staff"/>

        <!-- Portal User Management Action -->
        <record id="action_portal_user_management" model="ir.actions.act_window">
            <field name="name">Portal User Management</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">res.users</field>
            <field name="view_mode">list,form</field>
            <field name="domain">[('groups_id', 'in', [ref('ams_foundation.group_ams_member')])]</field>
            <field name="context">{
                'search_default_group_by_partner': 1,
                'search_default_active': 1
            }</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Manage member portal users
                </p>
                <p>
                    View and manage portal users for your association members.
                    Use the "Create Portal Users" wizard to bulk create portal access.
                </p>
            </field>
        </record>

        <!-- Portal User Management Menu -->
        <menuitem id="menu_ams_portal_user_management"
            name="Portal User Management"
            parent="menu_ams_tools"
            action="action_portal_user_management"
            sequence="20"
            groups="group_ams_staff"/>

        <!-- Members Without Portal Access Action -->
        <record id="action_portal_users_without_access" model="ir.actions.act_window">
            <field name="name">Members Without Portal Access</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">res.partner</field>
            <field name="view_mode">list,form</field>
            <field name="domain">[
                ('is_member', '=', True),
                ('member_status', 'in', ['active', 'grace']),
                ('portal_user_id', '=', False),
                ('email', '!=', False)
            ]</field>
            <field name="context">{
                'default_is_member': True,
                'search_default_group_member_type': 1
            }</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    All active members have portal access!
                </p>
                <p>
                    This list shows active members who don't have portal user accounts yet.
                    Use the "Create Portal Users" wizard to give them access.
                </p>
            </field>
        </record>

        <!-- Members Without Portal Access Menu -->
        <menuitem id="menu_ams_members_without_portal"
            name="Members Without Portal Access"
            parent="menu_ams_tools"
            action="action_portal_users_without_access"
            sequence="30"
            groups="group_ams_staff"/>

    </data>
</odoo>