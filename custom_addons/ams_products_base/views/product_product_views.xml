<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- ========================================================================== -->
    <!-- SIMPLIFIED AMS PRODUCT VARIANT FORM VIEW -->
    <!-- ========================================================================== -->
    <record id="product_variant_form_view_ams_simple" model="ir.ui.view">
        <field name="name">product.product.form.ams.simple</field>
        <field name="model">product.product</field>
        <field name="inherit_id" ref="product.product_normal_form_view"/>
        <field name="arch" type="xml">
            
            <!-- Add AMS indicator and SKU after default_code -->
            <xpath expr="//field[@name='default_code']" position="after">
                <field name="template_is_ams_product" readonly="1" widget="boolean_toggle" 
                       string="AMS Product"/>
                <field name="effective_sku" readonly="1" 
                       invisible="not template_is_ams_product" string="Effective SKU"/>
            </xpath>

            <!-- Add simplified AMS variant information -->
            <xpath expr="//notebook" position="inside">
                <page string="AMS Variant Info" name="ams_variant" 
                      invisible="not template_is_ams_product">
                    
                    <!-- Template Information Display -->
                    <group string="Template Configuration" name="template_config">
                        <group>
                            <field name="template_ams_category_display" readonly="1" 
                                   string="AMS Category"/>
                            <field name="template_requires_membership" readonly="1" 
                                   widget="boolean" string="Requires Membership"/>
                            <field name="template_has_digital_content" readonly="1" 
                                   widget="boolean" string="Has Digital Content"/>
                        </group>
                        <group>
                            <field name="availability_status" readonly="1"/>
                            <field name="variant_legacy_id" placeholder="Legacy variant ID"/>
                        </group>
                    </group>

                    <!-- Pricing Information -->
                    <group string="Pricing Information" name="pricing_info"
                           invisible="not template_member_price or template_member_price == lst_price">
                        <group>
                            <field name="lst_price" readonly="1" string="Regular Price"/>
                            <field name="template_member_price" readonly="1" 
                                   string="Member Price"/>
                        </group>
                        <group>
                            <div class="alert alert-info" role="alert">
                                <strong><i class="fa fa-info-circle"></i> Member Pricing</strong><br/>
                                This variant inherits member pricing from its template.
                            </div>
                        </group>
                    </group>

                    <!-- Information Panel - NO ACTION BUTTONS -->
                    <group string="Information" name="variant_info">
                        <div class="alert alert-info" role="alert">
                            <strong><i class="fa fa-info-circle"></i> AMS Variant</strong><br/>
                            This product variant inherits AMS features from its template.
                            To modify AMS settings, edit the product template.
                        </div>
                    </group>
                    
                </page>
            </xpath>
            
        </field>
    </record>

    <!-- ========================================================================== -->
    <!-- ENHANCED PRODUCT VARIANT LIST VIEW -->
    <!-- ========================================================================== -->
    <record id="product_variant_tree_view_ams_simple" model="ir.ui.view">
        <field name="name">product.product.tree.ams.simple</field>
        <field name="model">product.product</field>
        <field name="inherit_id" ref="product.product_product_tree_view"/>
        <field name="arch" type="xml">
            
            <!-- Add AMS columns after default_code -->
            <xpath expr="//field[@name='default_code']" position="after">
                <field name="effective_sku" string="Effective SKU" optional="show"/>
                <field name="template_is_ams_product" string="AMS" widget="boolean_toggle" optional="hide"/>
                <field name="template_ams_category_display" string="AMS Type" optional="hide"/>
                <field name="availability_status" string="Status" optional="hide"/>
            </xpath>

            <!-- Add member pricing columns -->
            <xpath expr="//field[@name='lst_price']" position="after">
                <field name="template_member_price" string="Member Price" optional="hide" 
                       widget="monetary" invisible="not template_member_price or template_member_price == lst_price"/>
            </xpath>

        </field>
    </record>

    <!-- ========================================================================== -->
    <!-- ENHANCED PRODUCT VARIANT SEARCH VIEW -->
    <!-- ========================================================================== -->
    <record id="product_variant_search_view_ams_simple" model="ir.ui.view">
        <field name="name">product.product.search.ams.simple</field>
        <field name="model">product.product</field>
        <field name="inherit_id" ref="product.product_search_form_view"/>
        <field name="arch" type="xml">
            
            <!-- Add AMS search fields -->
            <xpath expr="//field[@name='name']" position="after">
                <field name="effective_sku" string="Effective SKU" 
                       filter_domain="[('effective_sku', 'ilike', self)]"/>
                <field name="variant_legacy_id" string="Legacy Variant ID"/>
                <field name="template_ams_category_display" string="AMS Category"/>
            </xpath>

            <!-- Add AMS filters -->
            <xpath expr="//filter[@name='filter_to_sell']" position="after">
                <separator/>
                <filter name="ams_variants" string="AMS Product Variants" 
                        domain="[('template_is_ams_product', '=', True)]"/>
                <filter name="member_pricing_variants" string="Member Pricing Variants" 
                        domain="[('template_member_price', '>', 0)]"/>
                <filter name="digital_variants" string="Digital Variants" 
                        domain="[('template_has_digital_content', '=', True)]"/>
                <filter name="membership_required_variants" string="Membership Required Variants" 
                        domain="[('template_requires_membership', '=', True)]"/>
                
                <separator/>
                <filter name="available_variants" string="Available" 
                        domain="[('availability_status', 'in', ['digital_available', 'in_stock', 'service_available'])]"/>
                <filter name="unavailable_variants" string="Unavailable" 
                        domain="[('availability_status', 'in', ['digital_missing', 'out_of_stock'])]"/>
            </xpath>

            <!-- Add AMS grouping -->
            <xpath expr="//group[@expand='0']" position="inside">
                <filter string="AMS Category Type" name="group_ams_category" 
                        context="{'group_by': 'template_ams_category_display'}"/>
                <filter string="Availability Status" name="group_availability" 
                        context="{'group_by': 'availability_status'}"/>
                <filter string="Template" name="group_template" 
                        context="{'group_by': 'product_tmpl_id'}"/>
            </xpath>
            
        </field>
    </record>

    <!-- ========================================================================== -->
    <!-- AMS VARIANT ACTIONS - BASIC -->
    <!-- ========================================================================== -->
    
    <!-- Main AMS Variants Action -->
    <record id="action_ams_product_variants_simple" model="ir.actions.act_window">
        <field name="name">AMS Product Variants</field>
        <field name="res_model">product.product</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('template_is_ams_product', '=', True)]</field>
        <field name="context">{'search_default_ams_variants': 1}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                No AMS product variants found!
            </p>
            <p>
                AMS product variants inherit enhanced functionality from their templates
                including member pricing, digital content, and membership requirements.
            </p>
        </field>
    </record>

</odoo>