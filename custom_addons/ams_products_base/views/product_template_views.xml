<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- ========================================================================== -->
    <!-- SIMPLE FORM VIEW EXTENSIONS - Just add AMS fields to existing form -->
    <!-- ========================================================================== -->

    <record id="product_template_form_view_ams" model="ir.ui.view">
        <field name="name">product.template.form.ams</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_form_view"/>
        <field name="arch" type="xml">
            
            <!-- Add AMS fields to the General Information tab -->
            <xpath expr="//field[@name='categ_id']" position="after">
                <field name="is_ams_product" widget="boolean_toggle"/>
                <field name="ams_product_type_id" invisible="not is_ams_product"/>
                <field name="sku" invisible="not is_ams_product"/>
            </xpath>

            <!-- Add Member Pricing section to the Sales tab -->
            <xpath expr="//field[@name='list_price']" position="after">
                <field name="has_member_pricing" invisible="not is_ams_product"/>
                <field name="member_price" invisible="not has_member_pricing" widget="monetary"/>
                <field name="non_member_price" invisible="not has_member_pricing" widget="monetary"/>
            </xpath>

            <!-- Add AMS tab for additional settings -->
            <xpath expr="//notebook" position="inside">
                <page string="AMS Settings" invisible="not is_ams_product">
                    <group>
                        <group string="Access Control">
                            <field name="requires_membership"/>
                            <field name="chapter_specific"/>
                        </group>
                        <group string="Product Features">
                            <field name="is_digital_product"/>
                            <field name="stock_controlled"/>
                        </group>
                    </group>
                    
                    <group string="Digital Content" invisible="not is_digital_product">
                        <field name="digital_download_url" widget="url"/>
                        <field name="digital_attachment_id"/>
                        <field name="auto_fulfill_digital"/>
                    </group>
                    
                    <group string="Legacy Integration" groups="base.group_system">
                        <field name="legacy_product_id"/>
                    </group>
                </page>
            </xpath>

        </field>
    </record>

    <!-- ========================================================================== -->
    <!-- SIMPLE LIST VIEW EXTENSIONS - Just add AMS columns -->
    <!-- ========================================================================== -->

    <record id="product_template_tree_view_ams" model="ir.ui.view">
        <field name="name">product.template.tree.ams</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_tree_view"/>
        <field name="arch" type="xml">
            
            <!-- Add AMS columns -->
            <xpath expr="//field[@name='categ_id']" position="after">
                <field name="sku" optional="show"/>
                <field name="is_ams_product" optional="hide"/>
                <field name="has_member_pricing" optional="hide"/>
                <field name="member_price" optional="hide" widget="monetary"/>
            </xpath>

        </field>
    </record>

    <!-- ========================================================================== -->
    <!-- SIMPLE SEARCH VIEW EXTENSIONS - Add AMS filters -->
    <!-- ========================================================================== -->

    <record id="product_template_search_view_ams" model="ir.ui.view">
        <field name="name">product.template.search.ams</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_search_view"/>
        <field name="arch" type="xml">
            
            <!-- Add AMS search fields -->
            <xpath expr="//field[@name='name']" position="after">
                <field name="sku"/>
                <field name="ams_product_type_id"/>
            </xpath>

            <!-- Add AMS filters -->
            <xpath expr="//filter[@name='filter_to_sell']" position="after">
                <separator/>
                <filter name="ams_products" string="AMS Products" domain="[('is_ams_product', '=', True)]"/>
                <filter name="member_pricing" string="Member Pricing" domain="[('has_member_pricing', '=', True)]"/>
                <filter name="digital_products" string="Digital Products" domain="[('is_digital_product', '=', True)]"/>
            </xpath>

        </field>
    </record>

    <!-- ========================================================================== -->
    <!-- SIMPLE ACTIONS - Use existing Odoo product actions with domain filters -->
    <!-- ========================================================================== -->

    <!-- AMS Products - Just filter existing product action -->
    <record id="action_ams_products" model="ir.actions.act_window">
        <field name="name">AMS Products</field>
        <field name="res_model">product.template</field>
        <field name="view_mode">kanban,tree,form</field>
        <field name="domain">[('is_ams_product', '=', True)]</field>
        <field name="context">{'default_is_ams_product': True}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create your first AMS product!
            </p>
            <p>
                AMS products use Odoo's standard product management with association-specific features.
            </p>
        </field>
    </record>

    <!-- Member Pricing Products -->
    <record id="action_member_pricing_products" model="ir.actions.act_window">
        <field name="name">Member Pricing Products</field>
        <field name="res_model">product.template</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('has_member_pricing', '=', True)]</field>
        <field name="context">{'default_has_member_pricing': True}</field>
    </record>

</odoo>