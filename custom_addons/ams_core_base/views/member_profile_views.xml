<?xml version="1.0" encoding="utf-8"?>
<odoo>
    
    <!-- ===== MEMBER PROFILE FORM VIEW ===== -->
    <record id="view_member_profile_form" model="ir.ui.view">
        <field name="name">ams.member.profile.form</field>
        <field name="model">ams.member.profile</field>
        <field name="arch" type="xml">
            <form string="Member Profile">
                <header>
                    <button name="action_update_engagement_score" string="Update Engagement Score" 
                            type="object" class="btn-primary"/>
                    <button name="action_export_profile_data" string="Export Profile Data" 
                            type="object" class="btn-secondary" 
                            groups="ams_core_base.group_ams_privacy_officer"/>
                    <field name="profile_completeness" widget="percentpie" readonly="1"/>
                </header>
                
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button class="oe_stat_button" type="action" icon="fa-user">
                            <field name="partner_id" widget="statinfo" string="Member"/>
                        </button>
                    </div>
                    
                    <div class="oe_title">
                        <h1>
                            <field name="partner_id" readonly="1"/>
                        </h1>
                    </div>
                    
                    <notebook>
                        
                        <!-- Extended Demographics Tab -->
                        <page string="Demographics" name="demographics">
                            <group>
                                <group string="Educational Background">
                                    <field name="graduation_year"/>
                                    <field name="graduation_institution"/>
                                </group>
                                <group string="Personal Information" 
                                       groups="ams_core_base.group_ams_staff">
                                    <field name="ethnicity"/>
                                    <field name="primary_language"/>
                                </group>
                            </group>
                            
                            <group>
                                <group string="Languages">
                                    <field name="language_ids" widget="many2many_tags"/>
                                </group>
                                <group string="Geographic">
                                    <field name="time_zone"/>
                                    <field name="geographic_region"/>
                                </group>
                            </group>
                        </page>
                        
                        <!-- Professional Networks Tab -->
                        <page string="Professional Networks" name="networks">
                            <group>
                                <group string="Social Media">
                                    <field name="linkedin_url" widget="url"/>
                                    <field name="twitter_handle"/>
                                    <field name="researchgate_url" widget="url"/>
                                    <field name="orcid_id"/>
                                </group>
                                <group string="Other Networks">
                                    <field name="other_social_media" widget="text"/>
                                </group>
                            </group>
                        </page>
                        
                        <!-- Engagement & Interests Tab -->
                        <page string="Engagement" name="engagement">
                            <group>
                                <group string="Volunteer Information">
                                    <field name="volunteer_status"/>
                                    <field name="volunteer_skills" widget="text"/>
                                </group>
                                <group string="Interests &amp; Topics">
                                    <field name="interests_tags" widget="many2many_tags"/>
                                </group>
                            </group>
                            
                            <group>
                                <group string="Engagement Metrics">
                                    <field name="engagement_score" widget="progressbar"/>
                                    <field name="last_activity_date" readonly="1"/>
                                    <field name="total_events_attended"/>
                                </group>
                                <group string="Professional Development">
                                    <field name="continuing_education_hours"/>
                                    <field name="ce_hours_required"/>
                                    <field name="certification_expiry_date"/>
                                </group>
                            </group>
                        </page>
                        
                        <!-- Privacy & Consent Tab -->
                        <page string="Privacy &amp; Consent" name="privacy">
                            <group>
                                <group string="Consent Settings">
                                    <field name="marketing_consent"/>
                                    <field name="directory_listing_consent"/>
                                    <field name="photo_permission"/>
                                    <field name="data_sharing_consent"/>
                                </group>
                                <group string="Profile Visibility">
                                    <label for="profile_completeness"/>
                                    <div>
                                        <field name="profile_completeness" class="oe_inline"/> %
                                    </div>
                                </group>
                            </group>
                        </page>
                        
                        <!-- Emergency Contact Tab -->
                        <page string="Emergency Contact" name="emergency" 
                              groups="ams_core_base.group_ams_staff">
                            <group>
                                <group string="Emergency Contact Information">
                                    <field name="emergency_contact_name"/>
                                    <field name="emergency_contact_relationship"/>
                                    <field name="emergency_contact_phone"/>
                                    <field name="emergency_contact_email"/>
                                </group>
                            </group>
                        </page>
                        
                        <!-- Notes Tab -->
                        <page string="Notes" name="notes">
                            <group>
                                <group string="Member Notes" 
                                       help="Notes visible to the member">
                                    <field name="member_notes" widget="text" nolabel="1"/>
                                </group>
                                <group string="Internal Notes" 
                                       groups="ams_core_base.group_ams_staff"
                                       help="Internal staff notes about the member">
                                    <field name="internal_notes" widget="text" nolabel="1"/>
                                </group>
                            </group>
                        </page>
                        
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>
    
    <!-- ===== MEMBER PROFILE TREE VIEW ===== -->
    <record id="view_member_profile_tree" model="ir.ui.view">
        <field name="name">ams.member.profile.tree</field>
        <field name="model">ams.member.profile</field>
        <field name="arch" type="xml">
            <tree string="Member Profiles" default_order="partner_id">
                <field name="partner_id"/>
                <field name="graduation_year" optional="hide"/>
                <field name="graduation_institution" optional="hide"/>
                <field name="volunteer_status" optional="show"/>
                <field name="engagement_score" widget="progressbar" optional="show"/>
                <field name="profile_completeness" widget="progressbar" optional="show"/>
                <field name="continuing_education_hours" optional="hide"/>
                <field name="total_events_attended" optional="hide"/>
                <field name="last_activity_date" optional="hide"/>
                <field name="marketing_consent" optional="hide"/>
                <field name="directory_listing_consent" optional="hide"/>
            </tree>
        </field>
    </record>
    
    <!-- ===== MEMBER PROFILE KANBAN VIEW ===== -->
    <record id="view_member_profile_kanban" model="ir.ui.view">
        <field name="name">ams.member.profile.kanban</field>
        <field name="model">ams.member.profile</field>
        <field name="arch" type="xml">
            <kanban default_group_by="volunteer_status">
                <field name="partner_id"/>
                <field name="engagement_score"/>
                <field name="profile_completeness"/>
                <field name="volunteer_status"/>
                <field name="graduation_institution"/>
                <field name="total_events_attended"/>
                <field name="continuing_education_hours"/>
                
                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_card oe_kanban_global_click">
                            <div class="oe_kanban_content">
                                <div class="o_kanban_record_top">
                                    <div class="o_kanban_record_headings">
                                        <strong class="o_kanban_record_title">
                                            <field name="partner_id"/>
                                        </strong>
                                    </div>
                                    <div class="o_kanban_record_top_right">
                                        <span class="badge badge-pill badge-info" 
                                              t-if="record.engagement_score.raw_value >= 75">
                                            Highly Engaged
                                        </span>
                                        <span class="badge badge-pill badge-warning" 
                                              t-if="record.engagement_score.raw_value &lt; 25">
                                            At Risk
                                        </span>
                                    </div>
                                </div>
                                
                                <div class="o_kanban_record_body">
                                    <div t-if="record.graduation_institution.raw_value">
                                        <i class="fa fa-graduation-cap"/> 
                                        <t t-esc="record.graduation_institution.value"/>
                                    </div>
                                    <div>
                                        <i class="fa fa-chart-line"/> 
                                        Engagement: <t t-esc="record.engagement_score.value"/>%
                                    </div>
                                    <div>
                                        <i class="fa fa-user-check"/> 
                                        Profile: <t t-esc="record.profile_completeness.value"/>%
                                    </div>
                                </div>
                                
                                <div class="o_kanban_record_bottom">
                                    <div class="oe_kanban_bottom_left">
                                        <span t-if="record.total_events_attended.raw_value">
                                            <i class="fa fa-calendar"/> 
                                            <t t-esc="record.total_events_attended.value"/> events
                                        </span>
                                    </div>
                                    <div class="oe_kanban_bottom_right">
                                        <span t-if="record.continuing_education_hours.raw_value">
                                            <i class="fa fa-book"/> 
                                            <t t-esc="record.continuing_education_hours.value"/> CE hrs
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>
    
    <!-- ===== MEMBER PROFILE SEARCH VIEW ===== -->
    <record id="view_member_profile_search" model="ir.ui.view">
        <field name="name">ams.member.profile.search</field>
        <field name="model">ams.member.profile</field>
        <field name="arch" type="xml">
            <search string="Search Member Profiles">
                
                <field name="partner_id"/>
                <field name="graduation_institution"/>
                <field name="graduation_year"/>
                <field name="volunteer_status"/>
                <field name="interests_tags"/>
                
                <separator/>
                <filter string="High Engagement" name="high_engagement"
                        domain="[('engagement_score', '>=', 75)]"/>
                <filter string="Low Engagement" name="low_engagement"
                        domain="[('engagement_score', '&lt;', 25)]"/>
                <filter string="Incomplete Profiles" name="incomplete_profiles"
                        domain="[('profile_completeness', '&lt;', 60)]"/>
                
                <separator/>
                <filter string="Available Volunteers" name="available_volunteers"
                        domain="[('volunteer_status', '=', 'available')]"/>
                <filter string="Current Volunteers" name="current_volunteers"
                        domain="[('volunteer_status', '=', 'current_volunteer')]"/>
                
                <separator/>
                <filter string="Marketing Consent" name="marketing_consent"
                        domain="[('marketing_consent', '=', True)]"/>
                <filter string="Directory Listing" name="directory_consent"
                        domain="[('directory_listing_consent', '=', True)]"/>
                <filter string="Photo Permission" name="photo_permission"
                        domain="[('photo_permission', '=', True)]"/>
                
                <group expand="0" string="Group By">
                    <filter string="Volunteer Status" name="group_volunteer_status"
                            domain="[]" context="{'group_by': 'volunteer_status'}"/>
                    <filter string="Graduation Year" name="group_graduation_year"
                            domain="[]" context="{'group_by': 'graduation_year'}"/>
                    <filter string="Institution" name="group_institution"
                            domain="[]" context="{'group_by': 'graduation_institution'}"/>
                    <filter string="Primary Language" name="group_language"
                            domain="[]" context="{'group_by': 'primary_language'}"/>
                </group>
                
            </search>
        </field>
    </record>
    
    <!-- ===== MEMBER PROFILES ACTION ===== -->
    <record id="action_member_profiles" model="ir.actions.act_window">
        <field name="name">Member Profiles</field>
        <field name="res_model">ams.member.profile</field>
        <field name="view_mode">kanban,tree,form</field>
        <field name="search_view_id" ref="view_member_profile_search"/>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                No member profiles found!
            </p>
            <p>
                Member profiles are automatically created when members are added.
                Use the extended profile to track demographics, engagement, and professional development.
            </p>
        </field>
    </record>
    
    <!-- ===== HIGH ENGAGEMENT MEMBERS ACTION ===== -->
    <record id="action_high_engagement_profiles" model="ir.actions.act_window">
        <field name="name">High Engagement Members</field>
        <field name="res_model">ams.member.profile</field>
        <field name="view_mode">kanban,tree,form</field>
        <field name="domain">[('engagement_score', '>=', 75)]</field>
        <field name="search_view_id" ref="view_member_profile_search"/>
    </record>
    
    <!-- ===== AT RISK MEMBERS ACTION ===== -->
    <record id="action_at_risk_profiles" model="ir.actions.act_window">
        <field name="name">At Risk Members</field>
        <field name="res_model">ams.member.profile</field>
        <field name="view_mode">tree,kanban,form</field>
        <field name="domain">[('engagement_score', '&lt;', 25)]</field>
        <field name="search_view_id" ref="view_member_profile_search"/>
    </record>
    
    <!-- ===== INCOMPLETE PROFILES ACTION ===== -->
    <record id="action_incomplete_profiles" model="ir.actions.act_window">
        <field name="name">Incomplete Profiles</field>
        <field name="res_model">ams.member.profile</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('profile_completeness', '&lt;', 60)]</field>
        <field name="search_view_id" ref="view_member_profile_search"/>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                All profiles are complete!
            </p>
            <p>
                This list shows members with less than 60% profile completion.
                Encourage members to complete their profiles for better networking and engagement.
            </p>
        </field>
    </record>
    
    <!-- ===== VOLUNTEERS ACTION ===== -->
    <record id="action_volunteers" model="ir.actions.act_window">
        <field name="name">Volunteers</field>
        <field name="res_model">ams.member.profile</field>
        <field name="view_mode">kanban,tree,form</field>
        <field name="domain">[('volunteer_status', 'in', ['available', 'current_volunteer'])]</field>
        <field name="search_view_id" ref="view_member_profile_search"/>
    </record>
    
</odoo>