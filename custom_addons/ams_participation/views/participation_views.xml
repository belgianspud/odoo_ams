<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Create Participations parent menu under Members -->
    <menuitem id="menu_ams_participations" 
              name="Participations" 
              parent="ams_system_config.menu_ams_contacts"
              sequence="40"/>
    
    <!-- Create Reports parent menu under AMS -->
    <menuitem id="menu_ams_reports" 
              name="Reports" 
              parent="ams_system_config.menu_ams_root"
              sequence="90"/>

    <!-- Participation List View -->
    <record id="view_ams_participation_list" model="ir.ui.view">
        <field name="name">ams.participation.list</field>
        <field name="model">ams.participation</field>
        <field name="arch" type="xml">
            <list string="Participations" default_order="begin_date desc">
                <field name="member_display_name"/>
                <field name="participation_type"/>
                <field name="status"/>
                <field name="begin_date"/>
                <field name="end_date"/>
                <field name="paid_through_date"/>
                <field name="days_remaining"/>
            </list>
        </field>
    </record>

    <!-- MINIMAL Participation Form View for Debugging -->
    <record id="view_ams_participation_form" model="ir.ui.view">
        <field name="name">ams.participation.form</field>
        <field name="model">ams.participation</field>
        <field name="arch" type="xml">
            <form string="Participation">
                <header>
                    <field name="status" widget="statusbar" 
                           statusbar_visible="prospect,active,grace,suspended,terminated,cancelled"/>
                </header>

                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="display_name" readonly="1"/>
                        </h1>
                    </div>

                    <group>
                        <group string="Basic Information">
                            <field name="partner_id"/>
                            <field name="participation_type"/>
                        </group>
                        <group string="Dates">
                            <field name="join_date"/>
                            <field name="begin_date"/>
                            <field name="end_date"/>
                        </group>
                    </group>

                    <group>
                        <group string="Billing">
                            <field name="bill_through_date"/>
                            <field name="paid_through_date"/>
                        </group>
                        <group string="Settings">
                            <field name="auto_pay"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="Notes" name="notes">
                            <field name="notes" placeholder="Administrative notes..."/>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Simple Search View -->
    <record id="view_ams_participation_search" model="ir.ui.view">
        <field name="name">ams.participation.search</field>
        <field name="model">ams.participation</field>
        <field name="arch" type="xml">
            <search string="Search Participations">
                <field name="member_display_name"/>
                <field name="partner_id"/>
                <field name="company_id"/>
                <field name="participation_type"/>
                <field name="status"/>
                
                <!-- Status filters -->
                <filter string="Active" name="active" 
                        domain="[('status', '=', 'active')]"/>
                <filter string="Grace Period" name="grace" 
                        domain="[('status', '=', 'grace')]"/>
                <filter string="Prospects" name="prospects" 
                        domain="[('status', '=', 'prospect')]"/>
                <filter string="Suspended" name="suspended" 
                        domain="[('status', '=', 'suspended')]"/>
                <filter string="Terminated" name="terminated" 
                        domain="[('status', '=', 'terminated')]"/>
                <filter string="Cancelled" name="cancelled" 
                        domain="[('status', '=', 'cancelled')]"/>
                <separator/>
                
                <!-- Type filters -->
                <filter string="Memberships" name="memberships" 
                        domain="[('participation_type', '=', 'membership')]"/>
                <filter string="Chapters" name="chapters" 
                        domain="[('participation_type', '=', 'chapter')]"/>
                <filter string="Committees" name="committees" 
                        domain="[('participation_type', '=', 'committee_position')]"/>
                <separator/>
                
                <!-- Simple filters -->
                <filter string="Auto-Pay Enabled" name="auto_pay" 
                        domain="[('auto_pay', '=', True)]"/>
                <filter string="Individual Members" name="individuals" 
                        domain="[('partner_id', '!=', False)]"/>
                <filter string="Organization Members" name="organizations" 
                        domain="[('company_id', '!=', False)]"/>
                
                <group expand="0" string="Group By">
                    <filter string="Status" name="group_by_status" 
                            context="{'group_by': 'status'}"/>
                    <filter string="Participation Type" name="group_by_type" 
                            context="{'group_by': 'participation_type'}"/>
                    <filter string="Member" name="group_by_member" 
                            context="{'group_by': 'partner_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- All Participations Action - REMOVED DEFAULT FILTER -->
    <record id="action_ams_participation" model="ir.actions.act_window">
        <field name="name">All Participations</field>
        <field name="res_model">ams.participation</field>
        <field name="view_mode">list,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create your first participation
            </p>
            <p>
                Participations track all member engagement with your association.
            </p>
        </field>
    </record>

    <!-- STATUS-SPECIFIC ACTIONS -->
    
    <!-- Prospect Participations Action -->
    <record id="action_ams_participation_prospect" model="ir.actions.act_window">
        <field name="name">Prospect Participations</field>
        <field name="res_model">ams.participation</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('status', '=', 'prospect')]</field>
        <field name="context">{'search_default_prospects': 1}</field>
    </record>

    <!-- Active Participations Action -->
    <record id="action_ams_participation_active" model="ir.actions.act_window">
        <field name="name">Active Participations</field>
        <field name="res_model">ams.participation</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('status', '=', 'active')]</field>
        <field name="context">{'search_default_active': 1}</field>
    </record>

    <!-- Grace Participations Action - RENAMED -->
    <record id="action_ams_participation_grace" model="ir.actions.act_window">
        <field name="name">Grace Participations</field>
        <field name="res_model">ams.participation</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('status', '=', 'grace')]</field>
        <field name="context">{'search_default_grace': 1}</field>
    </record>

    <!-- Suspended Participations Action -->
    <record id="action_ams_participation_suspended" model="ir.actions.act_window">
        <field name="name">Suspended Participations</field>
        <field name="res_model">ams.participation</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('status', '=', 'suspended')]</field>
        <field name="context">{'search_default_suspended': 1}</field>
    </record>

    <!-- Terminated Participations Action -->
    <record id="action_ams_participation_terminated" model="ir.actions.act_window">
        <field name="name">Terminated Participations</field>
        <field name="res_model">ams.participation</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('status', '=', 'terminated')]</field>
        <field name="context">{'search_default_terminated': 1}</field>
    </record>

    <!-- Cancelled Participations Action -->
    <record id="action_ams_participation_cancelled" model="ir.actions.act_window">
        <field name="name">Cancelled Participations</field>
        <field name="res_model">ams.participation</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('status', '=', 'cancelled')]</field>
        <field name="context">{'search_default_cancelled': 1}</field>
    </record>

    <!-- TYPE-SPECIFIC ACTIONS -->

    <!-- Membership Participations Action -->
    <record id="action_ams_participation_membership" model="ir.actions.act_window">
        <field name="name">Membership Participations</field>
        <field name="res_model">ams.participation</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('participation_type', '=', 'membership')]</field>
        <field name="context">{'default_participation_type': 'membership'}</field>
    </record>

    <!-- Chapter Participations Action -->
    <record id="action_ams_participation_chapter" model="ir.actions.act_window">
        <field name="name">Chapter Participations</field>
        <field name="res_model">ams.participation</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('participation_type', '=', 'chapter')]</field>
        <field name="context">{'default_participation_type': 'chapter'}</field>
    </record>

    <!-- Committee Participations Action -->
    <record id="action_ams_participation_committee" model="ir.actions.act_window">
        <field name="name">Committee Participations</field>
        <field name="res_model">ams.participation</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('participation_type', '=', 'committee_position')]</field>
        <field name="context">{'default_participation_type': 'committee_position'}</field>
    </record>

    <!-- COMPREHENSIVE MENU STRUCTURE -->
    <!-- Main Participations menu -->
    <menuitem id="menu_ams_participations_main" 
              name="All Participations" 
              parent="menu_ams_participations"
              action="action_ams_participation" 
              sequence="10"/>

    <!-- BY STATUS SUBMENUS -->
    <menuitem id="menu_ams_participations_by_status" 
              name="By Status" 
              parent="menu_ams_participations"
              sequence="20"/>

    <menuitem id="menu_ams_participations_prospect" 
              name="Prospects" 
              parent="menu_ams_participations_by_status"
              action="action_ams_participation_prospect" 
              sequence="10"/>

    <menuitem id="menu_ams_participations_active" 
              name="Active" 
              parent="menu_ams_participations_by_status"
              action="action_ams_participation_active" 
              sequence="20"/>

    <menuitem id="menu_ams_participations_grace" 
              name="Grace" 
              parent="menu_ams_participations_by_status"
              action="action_ams_participation_grace" 
              sequence="30"/>

    <menuitem id="menu_ams_participations_suspended" 
              name="Suspended" 
              parent="menu_ams_participations_by_status"
              action="action_ams_participation_suspended" 
              sequence="40"/>

    <menuitem id="menu_ams_participations_terminated" 
              name="Terminated" 
              parent="menu_ams_participations_by_status"
              action="action_ams_participation_terminated" 
              sequence="50"/>

    <menuitem id="menu_ams_participations_cancelled" 
              name="Cancelled" 
              parent="menu_ams_participations_by_status"
              action="action_ams_participation_cancelled" 
              sequence="60"/>

    <!-- BY TYPE SUBMENUS -->
    <menuitem id="menu_ams_participations_by_type" 
              name="By Type" 
              parent="menu_ams_participations"
              sequence="30"/>

    <menuitem id="menu_ams_participations_membership" 
              name="Memberships" 
              parent="menu_ams_participations_by_type"
              action="action_ams_participation_membership" 
              sequence="10"/>

    <menuitem id="menu_ams_participations_chapter" 
              name="Chapters" 
              parent="menu_ams_participations_by_type"
              action="action_ams_participation_chapter" 
              sequence="20"/>

    <menuitem id="menu_ams_participations_committee" 
              name="Committees" 
              parent="menu_ams_participations_by_type"
              action="action_ams_participation_committee" 
              sequence="30"/>

    <!-- History submenu -->
    <menuitem id="menu_ams_participation_history" 
              name="Change History" 
              parent="menu_ams_participations"
              action="action_ams_participation_history" 
              sequence="50"/>

    <!-- Analytics submenu under Reports -->
    <menuitem id="menu_ams_participation_analytics" 
              name="Status Change Analytics" 
              parent="menu_ams_reports"
              action="action_ams_participation_history_report" 
              sequence="20"/>
</odoo>