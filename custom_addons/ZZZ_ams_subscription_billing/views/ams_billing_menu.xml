<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        
        <!-- Create Main AMS Root Menu (will use existing if available) -->
        <menuitem id="menu_ams_root"
                  name="AMS"
                  sequence="85"
                  web_icon="ams_subscription_billing,static/description/icon.png"/>
        
        <!-- Create Members Menu under AMS (if it doesn't exist) -->
        <menuitem id="menu_ams_members"
                  name="Members"
                  parent="menu_ams_root"
                  sequence="10"/>
        
        <!-- Main Billing Menu (under AMS root) -->
        <menuitem id="menu_ams_billing_root"
                  name="Billing"
                  parent="menu_ams_root"
                  sequence="80"/>
        
        <!-- Billing Operations Submenu -->
        <menuitem id="menu_ams_billing_operations"
                  name="Operations"
                  parent="menu_ams_billing_root"
                  sequence="10"/>
        
        <!-- Billing Schedules -->
        <menuitem id="menu_ams_billing_schedules"
                  name="Billing Schedules"
                  parent="menu_ams_billing_operations"
                  action="action_ams_billing_schedule"
                  sequence="10"/>
        
        <!-- Billing Events -->
        <menuitem id="menu_ams_billing_events"
                  name="Billing Events"
                  parent="menu_ams_billing_operations"
                  action="action_ams_billing_event"
                  sequence="20"/>
        
        <!-- Failed Billing Events -->
        <menuitem id="menu_ams_billing_events_failed"
                  name="Failed Events"
                  parent="menu_ams_billing_operations"
                  action="action_ams_billing_event_failed"
                  sequence="25"/>
        
        <!-- Manual Billing -->
        <menuitem id="menu_ams_manual_billing"
                  name="Manual Billing"
                  parent="menu_ams_billing_operations"
                  action="action_ams_manual_billing_wizard"
                  sequence="30"/>
        
        <!-- Subscription Billing Submenu -->
        <menuitem id="menu_ams_subscription_billing"
                  name="Subscriptions"
                  parent="menu_ams_billing_root"
                  sequence="20"/>
        
        <!-- Subscription Billing Dashboard -->
        <menuitem id="menu_ams_subscription_billing_dashboard"
                  name="Billing Dashboard"
                  parent="menu_ams_subscription_billing"
                  action="action_ams_subscription_billing_dashboard"
                  sequence="10"/>
        
        <!-- Overdue Subscriptions -->
        <menuitem id="menu_ams_subscription_overdue"
                  name="Overdue Subscriptions"
                  parent="menu_ams_subscription_billing"
                  action="action_ams_subscription_overdue"
                  sequence="20"/>
        
        <!-- All Subscriptions -->
        <record id="action_ams_subscription_all" model="ir.actions.act_window">
            <field name="name">All Subscriptions</field>
            <field name="res_model">ams.subscription</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Create your first subscription!
                </p>
                <p>
                    Manage customer subscriptions and automatic billing from here.
                </p>
            </field>
        </record>
        
        <menuitem id="menu_ams_subscription_all"
                  name="All Subscriptions"
                  parent="menu_ams_subscription_billing"
                  action="action_ams_subscription_all"
                  sequence="5"/>
        
        <!-- Invoices Submenu -->
        <menuitem id="menu_ams_billing_invoices"
                  name="Invoices"
                  parent="menu_ams_billing_root"
                  sequence="30"/>
        
        <!-- Subscription Invoices Action -->
        <record id="action_ams_subscription_invoices" model="ir.actions.act_window">
            <field name="name">Subscription Invoices</field>
            <field name="res_model">account.move</field>
            <field name="view_mode">list,form</field>
            <field name="domain">[('is_subscription_invoice', '=', True)]</field>
            <field name="context">{
                'default_move_type': 'out_invoice',
                'search_default_posted': 1
            }</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    No subscription invoices found!
                </p>
                <p>
                    This view shows all invoices generated from subscription billing.
                </p>
            </field>
        </record>
        
        <!-- Overdue Invoices Action -->
        <record id="action_ams_subscription_invoices_overdue" model="ir.actions.act_window">
            <field name="name">Overdue Subscription Invoices</field>
            <field name="res_model">account.move</field>
            <field name="view_mode">list,form</field>
            <field name="domain">[('is_subscription_invoice', '=', True), ('is_overdue', '=', True)]</field>
            <field name="context">{
                'default_move_type': 'out_invoice',
                'search_default_overdue': 1
            }</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    No overdue subscription invoices!
                </p>
                <p>
                    This view shows subscription invoices that are past due and need attention.
                </p>
            </field>
        </record>
        
        <!-- Subscription Invoices -->
        <menuitem id="menu_ams_subscription_invoices"
                  name="All Subscription Invoices"
                  parent="menu_ams_billing_invoices"
                  action="action_ams_subscription_invoices"
                  sequence="10"/>
        
        <!-- Overdue Invoices -->
        <menuitem id="menu_ams_subscription_invoices_overdue"
                  name="Overdue Invoices"
                  parent="menu_ams_billing_invoices"
                  action="action_ams_subscription_invoices_overdue"
                  sequence="20"/>
        
        <!-- Configuration Submenu -->
        <menuitem id="menu_ams_billing_configuration"
                  name="Configuration"
                  parent="menu_ams_billing_root"
                  sequence="90"/>
        
        <!-- Billing Configuration Action -->
        <record id="action_ams_billing_configuration" model="ir.actions.act_window">
            <field name="name">Billing Configuration</field>
            <field name="res_model">res.config.settings</field>
            <field name="view_mode">form</field>
            <field name="target">inline</field>
            <field name="context">{'module': 'ams_subscription_billing'}</field>
        </record>
        
        <!-- Email Templates Action -->
        <record id="action_ams_billing_email_templates" model="ir.actions.act_window">
            <field name="name">Billing Email Templates</field>
            <field name="res_model">mail.template</field>
            <field name="view_mode">list,form</field>
            <field name="domain">[('model', 'in', ['account.move', 'ams.billing.event'])]</field>
            <field name="context">{'search_default_billing_related': 1}</field>
        </record>
        
        <!-- Billing Settings -->
        <menuitem id="menu_ams_billing_settings"
                  name="Billing Settings"
                  parent="menu_ams_billing_configuration"
                  action="action_ams_billing_configuration"
                  sequence="10"/>
        
        <!-- Email Templates -->
        <menuitem id="menu_ams_billing_email_templates"
                  name="Email Templates"
                  parent="menu_ams_billing_configuration"
                  action="action_ams_billing_email_templates"
                  sequence="20"/>
        
        <!-- Reports Submenu -->
        <menuitem id="menu_ams_billing_reports"
                  name="Reports"
                  parent="menu_ams_billing_root"
                  sequence="80"/>
        
        <!-- Billing Summary Report Action -->
        <record id="action_ams_billing_summary_report" model="ir.actions.act_window">
            <field name="name">Billing Summary Report</field>
            <field name="res_model">ams.billing.event</field>
            <field name="view_mode">pivot,graph,list</field>
            <field name="domain">[('state', '=', 'completed')]</field>
            <field name="context">{
                'search_default_this_month': 1,
                'group_by': ['event_date:month', 'partner_id']
            }</field>
        </record>
        
        <!-- Payment Status Report Action -->
        <record id="action_ams_payment_status_report" model="ir.actions.act_window">
            <field name="name">Payment Status Report</field>
            <field name="res_model">ams.subscription</field>
            <field name="view_mode">pivot,graph,list</field>
            <field name="domain">[('enable_auto_billing', '=', True)]</field>
            <field name="context">{
                'group_by': ['payment_status', 'partner_id']
            }</field>
        </record>
        
        <!-- Billing Summary Report -->
        <menuitem id="menu_ams_billing_summary_report"
                  name="Billing Summary"
                  parent="menu_ams_billing_reports"
                  action="action_ams_billing_summary_report"
                  sequence="10"/>
        
        <!-- Payment Status Report -->
        <menuitem id="menu_ams_payment_status_report"
                  name="Payment Status"
                  parent="menu_ams_billing_reports"
                  action="action_ams_payment_status_report"
                  sequence="20"/>
        
        <!-- Quick Access Actions in Members Menu -->
        <menuitem id="menu_ams_members_billing_quick"
                  name="Billing Status"
                  parent="menu_ams_members"
                  action="action_ams_subscription_billing_dashboard"
                  sequence="50"/>
        
        <menuitem id="menu_ams_members_overdue_quick"
                  name="Overdue Payments"
                  parent="menu_ams_members"
                  action="action_ams_subscription_overdue"
                  sequence="51"/>
        
    </data>
</odoo>